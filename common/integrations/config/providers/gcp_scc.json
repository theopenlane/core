{
  "name": "gcp_scc",
  "displayName": "Google Cloud SCC",
  "category": "cloud",
  "authType": "workload_identity",
  "active": true,
  "visible": true,
  "logoUrl": "",
  "docsUrl": "https://docs.theopenlane.io/docs/platform/integrations/gcp_scc/overview",
  "googleWorkloadIdentity": {
    "scopes": [
      "https://www.googleapis.com/auth/cloud-platform"
    ],
    "tokenLifetime": "3600s",
    "subjectTokenType": "urn:ietf:params:oauth:token-type:id_token"
  },
  "persistence": {
    "storeRefreshToken": false
  },
  "labels": {
    "vendor": "google",
    "product": "security-command-center"
  },
  "credentialsSchema": {
    "type": "object",
    "additionalProperties": false,
    "allOf": [
      {
        "anyOf": [
          {
            "required": [
              "organizationId"
            ]
          },
          {
            "required": [
              "projectId"
            ]
          }
        ]
      },
      {
        "anyOf": [
          {
            "required": [
              "serviceAccountKey"
            ]
          },
          {
            "required": [
              "workloadIdentityProvider",
              "audience",
              "serviceAccountEmail",
              "subjectToken"
            ]
          }
        ]
      },
      {
        "if": {
          "properties": {
            "projectScope": {
              "const": "specific"
            }
          },
          "required": [
            "projectScope"
          ]
        },
        "then": {
          "required": [
            "projectIds"
          ]
        }
      }
    ],
    "properties": {
      "projectId": {
        "type": "string",
        "title": "GCP Project ID",
        "description": "Primary GCP project used for single-project SCC access and quota project defaults."
      },
      "workloadIdentityProvider": {
        "type": "string",
        "title": "Workload Identity Provider",
        "description": "Fully-qualified provider resource (e.g. projects/123/locations/global/workloadIdentityPools/pool/providers/provider)."
      },
      "audience": {
        "type": "string",
        "title": "STS Audience",
        "description": "Audience used when exchanging the subject token with Google STS."
      },
      "serviceAccountEmail": {
        "type": "string",
        "title": "Target Service Account",
        "description": "Service account email to impersonate for SCC calls."
      },
      "organizationId": {
        "type": "string",
        "title": "Organization ID",
        "description": "GCP organization used as the SCC parent for organization-wide collection."
      },
      "projectScope": {
        "type": "string",
        "title": "Project Scope",
        "description": "Collect across all accessible projects or restrict to a specific set of project IDs.",
        "enum": [
          "all",
          "specific"
        ],
        "default": "all"
      },
      "projectIds": {
        "type": "array",
        "title": "Project IDs",
        "description": "Required when Project Scope is specific. These project IDs are used to fan out source collection.",
        "items": {
          "type": "string"
        },
        "minItems": 1
      },
      "sourceId": {
        "type": "string",
        "title": "SCC Source ID",
        "description": "Optional SCC source identifier (e.g. organizations/123/sources/456) to scope findings."
      },
      "sourceIds": {
        "type": "array",
        "title": "SCC Source IDs",
        "description": "Optional list of SCC source identifiers. Bare source IDs are expanded against selected parents.",
        "items": {
          "type": "string"
        }
      },
      "scopes": {
        "type": "array",
        "title": "Additional OAuth Scopes",
        "description": "Optional extra OAuth scopes requested when impersonating the target service account.",
        "items": {
          "type": "string"
        },
        "default": [
          "https://www.googleapis.com/auth/cloud-platform"
        ]
      },
      "tokenLifetime": {
        "type": "string",
        "title": "Access Token Lifetime",
        "description": "Optional access token lifetime (Go duration, e.g. 3600s).",
        "default": "3600s"
      },
      "audienceHint": {
        "type": "string",
        "title": "Audience Override",
        "description": "Optional audience override if multiple STS exchanges are supported."
      },
      "workloadPoolProject": {
        "type": "string",
        "title": "Workload Identity Project",
        "description": "Optional project that owns the workload identity pool when different from projectId."
      },
      "findingFilter": {
        "type": "string",
        "title": "Findings Filter",
        "description": "Optional CEL filter applied when querying SCC findings."
      },
      "subjectToken": {
        "type": "string",
        "title": "Subject Token",
        "description": "External identity token (JWT/SAML/OIDC) used as the workload identity subject when STS exchanges occur.",
        "minLength": 1
      },
      "serviceAccountKey": {
        "type": "string",
        "title": "Service Account Key JSON",
        "description": "Paste a Google Cloud service-account JSON key to mint access tokens directly (testing shortcut).",
        "minLength": 1
      }
    }
  },
  "description": "Collect Google Cloud Security Command Center findings and settings using workload identity or service-account based access."
}
