############################################
# Tuples for testing the FGA implementation
# This file is specific to workflow types:
#   - workflow_definition
#   - workflow_instance
#   - workflow_assignment
#   - workflow_object_ref
#   - workflow_assignment_target
#   - workflow_event
#   - workflow_proposal
############################################

# workflow_definition-1 is owned by openlane organization
- user: organization:openlane
  relation: parent
  object: workflow_definition:workflow_definition-1

# org owner has editor access via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_definition:workflow_definition-1

# workflow_instance-1 is owned by openlane organization and linked to workflow_definition-1
- user: organization:openlane
  relation: parent
  object: workflow_instance:workflow_instance-1
- user: workflow_definition:workflow_definition-1
  relation: parent
  object: workflow_instance:workflow_instance-1

# org owner has editor access to workflow_instance via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_instance:workflow_instance-1

# workflow_assignment-1 is linked to workflow_instance-1
- user: organization:openlane
  relation: parent
  object: workflow_assignment:workflow_assignment-1
- user: workflow_instance:workflow_instance-1
  relation: parent
  object: workflow_assignment:workflow_assignment-1

# org owner has editor access to workflow_assignment via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_assignment:workflow_assignment-1

# workflow_object_ref-1 is linked to workflow_instance-1
- user: organization:openlane
  relation: parent
  object: workflow_object_ref:workflow_object_ref-1
- user: workflow_instance:workflow_instance-1
  relation: parent
  object: workflow_object_ref:workflow_object_ref-1

# org owner has editor access to workflow_object_ref via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_object_ref:workflow_object_ref-1

# blocked user for workflow_object_ref
- user: user:ulid-blocked
  relation: blocked
  object: workflow_object_ref:workflow_object_ref-1

# workflow_assignment_target-1 is linked to workflow_assignment-1
- user: organization:openlane
  relation: parent
  object: workflow_assignment_target:workflow_assignment_target-1
- user: workflow_assignment:workflow_assignment-1
  relation: parent
  object: workflow_assignment_target:workflow_assignment_target-1

# org owner has editor access to workflow_assignment_target via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_assignment_target:workflow_assignment_target-1

# blocked user for workflow_assignment_target
- user: user:ulid-blocked
  relation: blocked
  object: workflow_assignment_target:workflow_assignment_target-1

# workflow_event-1 is linked to workflow_instance-1
- user: organization:openlane
  relation: parent
  object: workflow_event:workflow_event-1
- user: workflow_instance:workflow_instance-1
  relation: parent
  object: workflow_event:workflow_event-1

# org owner has editor access to workflow_event via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_event:workflow_event-1

# blocked user for workflow_event
- user: user:ulid-blocked
  relation: blocked
  object: workflow_event:workflow_event-1

# setup a group for workflow editor access
- user: organization:openlane
  relation: parent
  object: group:workflow-editors
  condition:
    name: public_group
    context:
      public: false

- user: user:ulid-workflow-editor
  relation: member
  object: group:workflow-editors

# group editor access for workflow types
- user: group:workflow-editors#member
  relation: editor
  object: workflow_definition:workflow_definition-1
- user: group:workflow-editors#member
  relation: editor
  object: workflow_instance:workflow_instance-1
- user: group:workflow-editors#member
  relation: editor
  object: workflow_assignment:workflow_assignment-1
- user: group:workflow-editors#member
  relation: editor
  object: workflow_object_ref:workflow_object_ref-1
- user: group:workflow-editors#member
  relation: editor
  object: workflow_assignment_target:workflow_assignment_target-1
- user: group:workflow-editors#member
  relation: editor
  object: workflow_event:workflow_event-1
- user: group:workflow-editors#member
  relation: editor
  object: workflow_proposal:workflow_proposal-1

# workflow_proposal-1 is linked to workflow_object_ref-1
- user: organization:openlane
  relation: parent
  object: workflow_proposal:workflow_proposal-1
- user: workflow_object_ref:workflow_object_ref-1
  relation: parent
  object: workflow_proposal:workflow_proposal-1

# org owner has editor access to workflow_proposal via organization
- user: organization:openlane#owner
  relation: editor
  object: workflow_proposal:workflow_proposal-1

# blocked user for workflow_proposal
- user: user:ulid-blocked
  relation: blocked
  object: workflow_proposal:workflow_proposal-1
