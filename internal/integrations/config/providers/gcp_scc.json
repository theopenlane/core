{
  "name": "gcp_scc",
  "displayName": "Google Cloud SCC",
  "category": "cloud",
  "authType": "workload_identity",
  "active": true,
  "logoUrl": "",
  "docsUrl": "https://cloud.google.com/security-command-center/docs",
  "workloadIdentity": {
    "scopes": [
      "https://www.googleapis.com/auth/cloud-platform"
    ],
    "tokenLifetime": "3600s",
    "subjectTokenType": "urn:ietf:params:oauth:token-type:id_token"
  },
  "persistence": {
    "storeRefreshToken": false
  },
  "labels": {
    "vendor": "google",
    "product": "security-command-center"
  },
  "credentialsSchema": {
    "type": "object",
    "additionalProperties": false,
    "required": [
      "projectId"
    ],
    "allOf": [
      {
        "anyOf": [
          {
            "required": [
              "serviceAccountKey"
            ]
          },
          {
            "required": [
              "workloadIdentityProvider",
              "audience",
              "serviceAccountEmail",
              "organizationId",
              "subjectToken"
            ]
          }
        ]
      }
    ],
    "properties": {
      "projectId": {
        "type": "string",
        "title": "GCP Project ID",
        "description": "Project that owns the Security Command Center resources."
      },
      "workloadIdentityProvider": {
        "type": "string",
        "title": "Workload Identity Provider",
        "description": "Fully-qualified provider resource (e.g. projects/123/locations/global/workloadIdentityPools/pool/providers/provider)."
      },
      "audience": {
        "type": "string",
        "title": "STS Audience",
        "description": "Audience used when exchanging the subject token with Google STS."
      },
      "serviceAccountEmail": {
        "type": "string",
        "title": "Target Service Account",
        "description": "Service account email to impersonate for SCC calls."
      },
      "organizationId": {
        "type": "string",
        "title": "Organization ID",
        "description": "GCP organization to scope SCC queries."
      },
      "sourceId": {
        "type": "string",
        "title": "SCC Source ID",
        "description": "Optional SCC source identifier (e.g. organizations/123/sources/456) to scope findings."
      },
      "scopes": {
        "type": "array",
        "title": "Additional OAuth Scopes",
        "description": "Optional extra OAuth scopes requested when impersonating the target service account.",
        "items": {
          "type": "string"
        },
        "default": [
          "https://www.googleapis.com/auth/cloud-platform"
        ]
      },
      "tokenLifetime": {
        "type": "string",
        "title": "Access Token Lifetime",
        "description": "Optional access token lifetime (Go duration, e.g. 3600s).",
        "default": "3600s"
      },
      "audienceHint": {
        "type": "string",
        "title": "Audience Override",
        "description": "Optional audience override if multiple STS exchanges are supported."
      },
      "workloadPoolProject": {
        "type": "string",
        "title": "Workload Identity Project",
        "description": "Optional project that owns the workload identity pool when different from projectId."
      },
      "findingFilter": {
        "type": "string",
        "title": "Findings Filter",
        "description": "Optional CEL filter applied when querying SCC findings."
      },
      "subjectToken": {
        "type": "string",
        "title": "Subject Token",
        "description": "External identity token (JWT/SAML/OIDC) used as the workload identity subject when STS exchanges occur.",
        "minLength": 1
      },
      "serviceAccountKey": {
        "type": "string",
        "title": "Service Account Key JSON",
        "description": "Paste a Google Cloud service-account JSON key to mint access tokens directly (testing shortcut).",
        "minLength": 1
      }
    }
  }
}
