package graphapihistory

// This file will be automatically regenerated based on the schema, any resolver
// implementations
// will be copied through when generating and any unknown code will be moved to the end.
// Code generated by github.com/99designs/gqlgen

import (
	"context"
	"fmt"

	"entgo.io/contrib/entgql"
	"github.com/theopenlane/core/internal/ent/historygenerated"
	"github.com/theopenlane/core/internal/graphapi/common"
	gqlhistorygenerated "github.com/theopenlane/core/internal/graphapi/historygenerated"
	"github.com/theopenlane/gqlgen-plugins/graphutils"
)

// TestingProcedures is the resolver for the testingProcedures field.
func (r *controlHistoryResolver) TestingProcedures(ctx context.Context, obj *historygenerated.ControlHistory) ([]string, error) {
	panic(fmt.Errorf("not implemented: TestingProcedures - testingProcedures"))
}

// EvidenceRequests is the resolver for the evidenceRequests field.
func (r *controlHistoryResolver) EvidenceRequests(ctx context.Context, obj *historygenerated.ControlHistory) ([]string, error) {
	panic(fmt.Errorf("not implemented: EvidenceRequests - evidenceRequests"))
}

// Node is the resolver for the node field.
func (r *queryResolver) Node(ctx context.Context, id string) (historygenerated.Noder, error) {
	res, err := withTransactionalMutation(ctx).Noder(ctx, id)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "node"})
	}

	return res, nil
}

// Nodes is the resolver for the nodes field.
func (r *queryResolver) Nodes(ctx context.Context, ids []string) ([]historygenerated.Noder, error) {
	res, err := withTransactionalMutation(ctx).Noders(ctx, ids)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "node"})
	}

	return res, nil
}

// ActionPlanHistories is the resolver for the actionPlanHistories field.
func (r *queryResolver) ActionPlanHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ActionPlanHistoryOrder, where *historygenerated.ActionPlanHistoryWhereInput) (*historygenerated.ActionPlanHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ActionPlanHistoryOrder{
			Field:     historygenerated.ActionPlanHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ActionPlanHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "actionplanhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithActionPlanHistoryOrder(orderBy),
		historygenerated.WithActionPlanHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "actionplanhistory"})
	}

	return res, err
}

// AssessmentHistories is the resolver for the assessmentHistories field.
func (r *queryResolver) AssessmentHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.AssessmentHistoryOrder, where *historygenerated.AssessmentHistoryWhereInput) (*historygenerated.AssessmentHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.AssessmentHistoryOrder{
			Field:     historygenerated.AssessmentHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).AssessmentHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "assessmenthistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithAssessmentHistoryOrder(orderBy),
		historygenerated.WithAssessmentHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "assessmenthistory"})
	}

	return res, err
}

// AssessmentResponseHistories is the resolver for the assessmentResponseHistories field.
func (r *queryResolver) AssessmentResponseHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.AssessmentResponseHistoryOrder, where *historygenerated.AssessmentResponseHistoryWhereInput) (*historygenerated.AssessmentResponseHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.AssessmentResponseHistoryOrder{
			Field:     historygenerated.AssessmentResponseHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).AssessmentResponseHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "assessmentresponsehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithAssessmentResponseHistoryOrder(orderBy),
		historygenerated.WithAssessmentResponseHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "assessmentresponsehistory"})
	}

	return res, err
}

// AssetHistories is the resolver for the assetHistories field.
func (r *queryResolver) AssetHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.AssetHistoryOrder, where *historygenerated.AssetHistoryWhereInput) (*historygenerated.AssetHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.AssetHistoryOrder{
			Field:     historygenerated.AssetHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).AssetHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "assethistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithAssetHistoryOrder(orderBy),
		historygenerated.WithAssetHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "assethistory"})
	}

	return res, err
}

// ContactHistories is the resolver for the contactHistories field.
func (r *queryResolver) ContactHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ContactHistoryOrder, where *historygenerated.ContactHistoryWhereInput) (*historygenerated.ContactHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ContactHistoryOrder{
			Field:     historygenerated.ContactHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ContactHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "contacthistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithContactHistoryOrder(orderBy),
		historygenerated.WithContactHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "contacthistory"})
	}

	return res, err
}

// ControlHistories is the resolver for the controlHistories field.
func (r *queryResolver) ControlHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ControlHistoryOrder, where *historygenerated.ControlHistoryWhereInput) (*historygenerated.ControlHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ControlHistoryOrder{
			Field:     historygenerated.ControlHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ControlHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "controlhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithControlHistoryOrder(orderBy),
		historygenerated.WithControlHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "controlhistory"})
	}

	return res, err
}

// ControlImplementationHistories is the resolver for the controlImplementationHistories field.
func (r *queryResolver) ControlImplementationHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ControlImplementationHistoryOrder, where *historygenerated.ControlImplementationHistoryWhereInput) (*historygenerated.ControlImplementationHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ControlImplementationHistoryOrder{
			Field:     historygenerated.ControlImplementationHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ControlImplementationHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "controlimplementationhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithControlImplementationHistoryOrder(orderBy),
		historygenerated.WithControlImplementationHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "controlimplementationhistory"})
	}

	return res, err
}

// ControlObjectiveHistories is the resolver for the controlObjectiveHistories field.
func (r *queryResolver) ControlObjectiveHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ControlObjectiveHistoryOrder, where *historygenerated.ControlObjectiveHistoryWhereInput) (*historygenerated.ControlObjectiveHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ControlObjectiveHistoryOrder{
			Field:     historygenerated.ControlObjectiveHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ControlObjectiveHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "controlobjectivehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithControlObjectiveHistoryOrder(orderBy),
		historygenerated.WithControlObjectiveHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "controlobjectivehistory"})
	}

	return res, err
}

// CustomDomainHistories is the resolver for the customDomainHistories field.
func (r *queryResolver) CustomDomainHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.CustomDomainHistoryOrder, where *historygenerated.CustomDomainHistoryWhereInput) (*historygenerated.CustomDomainHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.CustomDomainHistoryOrder{
			Field:     historygenerated.CustomDomainHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).CustomDomainHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "customdomainhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithCustomDomainHistoryOrder(orderBy),
		historygenerated.WithCustomDomainHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "customdomainhistory"})
	}

	return res, err
}

// DNSVerificationHistories is the resolver for the dnsVerificationHistories field.
func (r *queryResolver) DNSVerificationHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.DNSVerificationHistoryOrder, where *historygenerated.DNSVerificationHistoryWhereInput) (*historygenerated.DNSVerificationHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.DNSVerificationHistoryOrder{
			Field:     historygenerated.DNSVerificationHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).DNSVerificationHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "dnsverificationhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithDNSVerificationHistoryOrder(orderBy),
		historygenerated.WithDNSVerificationHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "dnsverificationhistory"})
	}

	return res, err
}

// DirectoryAccountHistories is the resolver for the directoryAccountHistories field.
func (r *queryResolver) DirectoryAccountHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.DirectoryAccountHistoryOrder, where *historygenerated.DirectoryAccountHistoryWhereInput) (*historygenerated.DirectoryAccountHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.DirectoryAccountHistoryOrder{
			Field:     historygenerated.DirectoryAccountHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).DirectoryAccountHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "directoryaccounthistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithDirectoryAccountHistoryOrder(orderBy),
		historygenerated.WithDirectoryAccountHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "directoryaccounthistory"})
	}

	return res, err
}

// DirectoryGroupHistories is the resolver for the directoryGroupHistories field.
func (r *queryResolver) DirectoryGroupHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.DirectoryGroupHistoryOrder, where *historygenerated.DirectoryGroupHistoryWhereInput) (*historygenerated.DirectoryGroupHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.DirectoryGroupHistoryOrder{
			Field:     historygenerated.DirectoryGroupHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).DirectoryGroupHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "directorygrouphistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithDirectoryGroupHistoryOrder(orderBy),
		historygenerated.WithDirectoryGroupHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "directorygrouphistory"})
	}

	return res, err
}

// DirectoryMembershipHistories is the resolver for the directoryMembershipHistories field.
func (r *queryResolver) DirectoryMembershipHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.DirectoryMembershipHistoryOrder, where *historygenerated.DirectoryMembershipHistoryWhereInput) (*historygenerated.DirectoryMembershipHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.DirectoryMembershipHistoryOrder{
			Field:     historygenerated.DirectoryMembershipHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).DirectoryMembershipHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "directorymembershiphistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithDirectoryMembershipHistoryOrder(orderBy),
		historygenerated.WithDirectoryMembershipHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "directorymembershiphistory"})
	}

	return res, err
}

// DiscussionHistories is the resolver for the discussionHistories field.
func (r *queryResolver) DiscussionHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.DiscussionHistoryOrder, where *historygenerated.DiscussionHistoryWhereInput) (*historygenerated.DiscussionHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.DiscussionHistoryOrder{
			Field:     historygenerated.DiscussionHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).DiscussionHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "discussionhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithDiscussionHistoryOrder(orderBy),
		historygenerated.WithDiscussionHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "discussionhistory"})
	}

	return res, err
}

// DocumentDataHistories is the resolver for the documentDataHistories field.
func (r *queryResolver) DocumentDataHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.DocumentDataHistoryOrder, where *historygenerated.DocumentDataHistoryWhereInput) (*historygenerated.DocumentDataHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.DocumentDataHistoryOrder{
			Field:     historygenerated.DocumentDataHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).DocumentDataHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "documentdatahistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithDocumentDataHistoryOrder(orderBy),
		historygenerated.WithDocumentDataHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "documentdatahistory"})
	}

	return res, err
}

// EntityHistories is the resolver for the entityHistories field.
func (r *queryResolver) EntityHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.EntityHistoryOrder, where *historygenerated.EntityHistoryWhereInput) (*historygenerated.EntityHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.EntityHistoryOrder{
			Field:     historygenerated.EntityHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).EntityHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "entityhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithEntityHistoryOrder(orderBy),
		historygenerated.WithEntityHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "entityhistory"})
	}

	return res, err
}

// EntityTypeHistories is the resolver for the entityTypeHistories field.
func (r *queryResolver) EntityTypeHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.EntityTypeHistoryOrder, where *historygenerated.EntityTypeHistoryWhereInput) (*historygenerated.EntityTypeHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.EntityTypeHistoryOrder{
			Field:     historygenerated.EntityTypeHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).EntityTypeHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "entitytypehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithEntityTypeHistoryOrder(orderBy),
		historygenerated.WithEntityTypeHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "entitytypehistory"})
	}

	return res, err
}

// EvidenceHistories is the resolver for the evidenceHistories field.
func (r *queryResolver) EvidenceHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.EvidenceHistoryOrder, where *historygenerated.EvidenceHistoryWhereInput) (*historygenerated.EvidenceHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.EvidenceHistoryOrder{
			Field:     historygenerated.EvidenceHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).EvidenceHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "evidencehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithEvidenceHistoryOrder(orderBy),
		historygenerated.WithEvidenceHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "evidencehistory"})
	}

	return res, err
}

// FileHistories is the resolver for the fileHistories field.
func (r *queryResolver) FileHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.FileHistoryOrder, where *historygenerated.FileHistoryWhereInput) (*historygenerated.FileHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.FileHistoryOrder{
			Field:     historygenerated.FileHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).FileHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "filehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithFileHistoryOrder(orderBy),
		historygenerated.WithFileHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "filehistory"})
	}

	return res, err
}

// FindingControlHistories is the resolver for the findingControlHistories field.
func (r *queryResolver) FindingControlHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.FindingControlHistoryOrder, where *historygenerated.FindingControlHistoryWhereInput) (*historygenerated.FindingControlHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.FindingControlHistoryOrder{
			Field:     historygenerated.FindingControlHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).FindingControlHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "findingcontrolhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithFindingControlHistoryOrder(orderBy),
		historygenerated.WithFindingControlHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "findingcontrolhistory"})
	}

	return res, err
}

// FindingHistories is the resolver for the findingHistories field.
func (r *queryResolver) FindingHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.FindingHistoryOrder, where *historygenerated.FindingHistoryWhereInput) (*historygenerated.FindingHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.FindingHistoryOrder{
			Field:     historygenerated.FindingHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).FindingHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "findinghistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithFindingHistoryOrder(orderBy),
		historygenerated.WithFindingHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "findinghistory"})
	}

	return res, err
}

// GroupHistories is the resolver for the groupHistories field.
func (r *queryResolver) GroupHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.GroupHistoryOrder, where *historygenerated.GroupHistoryWhereInput) (*historygenerated.GroupHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.GroupHistoryOrder{
			Field:     historygenerated.GroupHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).GroupHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "grouphistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithGroupHistoryOrder(orderBy),
		historygenerated.WithGroupHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "grouphistory"})
	}

	return res, err
}

// GroupMembershipHistories is the resolver for the groupMembershipHistories field.
func (r *queryResolver) GroupMembershipHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.GroupMembershipHistoryOrder, where *historygenerated.GroupMembershipHistoryWhereInput) (*historygenerated.GroupMembershipHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.GroupMembershipHistoryOrder{
			Field:     historygenerated.GroupMembershipHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).GroupMembershipHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "groupmembershiphistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithGroupMembershipHistoryOrder(orderBy),
		historygenerated.WithGroupMembershipHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "groupmembershiphistory"})
	}

	return res, err
}

// GroupSettingHistories is the resolver for the groupSettingHistories field.
func (r *queryResolver) GroupSettingHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.GroupSettingHistoryOrder, where *historygenerated.GroupSettingHistoryWhereInput) (*historygenerated.GroupSettingHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.GroupSettingHistoryOrder{
			Field:     historygenerated.GroupSettingHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).GroupSettingHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "groupsettinghistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithGroupSettingHistoryOrder(orderBy),
		historygenerated.WithGroupSettingHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "groupsettinghistory"})
	}

	return res, err
}

// HushHistories is the resolver for the hushHistories field.
func (r *queryResolver) HushHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.HushHistoryOrder, where *historygenerated.HushHistoryWhereInput) (*historygenerated.HushHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.HushHistoryOrder{
			Field:     historygenerated.HushHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).HushHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "hushhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithHushHistoryOrder(orderBy),
		historygenerated.WithHushHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "hushhistory"})
	}

	return res, err
}

// IntegrationHistories is the resolver for the integrationHistories field.
func (r *queryResolver) IntegrationHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.IntegrationHistoryOrder, where *historygenerated.IntegrationHistoryWhereInput) (*historygenerated.IntegrationHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.IntegrationHistoryOrder{
			Field:     historygenerated.IntegrationHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).IntegrationHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "integrationhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithIntegrationHistoryOrder(orderBy),
		historygenerated.WithIntegrationHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "integrationhistory"})
	}

	return res, err
}

// InternalPolicyHistories is the resolver for the internalPolicyHistories field.
func (r *queryResolver) InternalPolicyHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.InternalPolicyHistoryOrder, where *historygenerated.InternalPolicyHistoryWhereInput) (*historygenerated.InternalPolicyHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.InternalPolicyHistoryOrder{
			Field:     historygenerated.InternalPolicyHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).InternalPolicyHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "internalpolicyhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithInternalPolicyHistoryOrder(orderBy),
		historygenerated.WithInternalPolicyHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "internalpolicyhistory"})
	}

	return res, err
}

// JobTemplateHistories is the resolver for the jobTemplateHistories field.
func (r *queryResolver) JobTemplateHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.JobTemplateHistoryOrder, where *historygenerated.JobTemplateHistoryWhereInput) (*historygenerated.JobTemplateHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.JobTemplateHistoryOrder{
			Field:     historygenerated.JobTemplateHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).JobTemplateHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "jobtemplatehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithJobTemplateHistoryOrder(orderBy),
		historygenerated.WithJobTemplateHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "jobtemplatehistory"})
	}

	return res, err
}

// MappableDomainHistories is the resolver for the mappableDomainHistories field.
func (r *queryResolver) MappableDomainHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.MappableDomainHistoryOrder, where *historygenerated.MappableDomainHistoryWhereInput) (*historygenerated.MappableDomainHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.MappableDomainHistoryOrder{
			Field:     historygenerated.MappableDomainHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).MappableDomainHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "mappabledomainhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithMappableDomainHistoryOrder(orderBy),
		historygenerated.WithMappableDomainHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "mappabledomainhistory"})
	}

	return res, err
}

// MappedControlHistories is the resolver for the mappedControlHistories field.
func (r *queryResolver) MappedControlHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.MappedControlHistoryOrder, where *historygenerated.MappedControlHistoryWhereInput) (*historygenerated.MappedControlHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.MappedControlHistoryOrder{
			Field:     historygenerated.MappedControlHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).MappedControlHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "mappedcontrolhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithMappedControlHistoryOrder(orderBy),
		historygenerated.WithMappedControlHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "mappedcontrolhistory"})
	}

	return res, err
}

// NarrativeHistories is the resolver for the narrativeHistories field.
func (r *queryResolver) NarrativeHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.NarrativeHistoryOrder, where *historygenerated.NarrativeHistoryWhereInput) (*historygenerated.NarrativeHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.NarrativeHistoryOrder{
			Field:     historygenerated.NarrativeHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).NarrativeHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "narrativehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithNarrativeHistoryOrder(orderBy),
		historygenerated.WithNarrativeHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "narrativehistory"})
	}

	return res, err
}

// NoteHistories is the resolver for the noteHistories field.
func (r *queryResolver) NoteHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.NoteHistoryOrder, where *historygenerated.NoteHistoryWhereInput) (*historygenerated.NoteHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.NoteHistoryOrder{
			Field:     historygenerated.NoteHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).NoteHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "notehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithNoteHistoryOrder(orderBy),
		historygenerated.WithNoteHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "notehistory"})
	}

	return res, err
}

// OrgMembershipHistories is the resolver for the orgMembershipHistories field.
func (r *queryResolver) OrgMembershipHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.OrgMembershipHistoryOrder, where *historygenerated.OrgMembershipHistoryWhereInput) (*historygenerated.OrgMembershipHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.OrgMembershipHistoryOrder{
			Field:     historygenerated.OrgMembershipHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).OrgMembershipHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "orgmembershiphistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithOrgMembershipHistoryOrder(orderBy),
		historygenerated.WithOrgMembershipHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "orgmembershiphistory"})
	}

	return res, err
}

// OrgSubscriptionHistories is the resolver for the orgSubscriptionHistories field.
func (r *queryResolver) OrgSubscriptionHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.OrgSubscriptionHistoryOrder, where *historygenerated.OrgSubscriptionHistoryWhereInput) (*historygenerated.OrgSubscriptionHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.OrgSubscriptionHistoryOrder{
			Field:     historygenerated.OrgSubscriptionHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).OrgSubscriptionHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "orgsubscriptionhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithOrgSubscriptionHistoryOrder(orderBy),
		historygenerated.WithOrgSubscriptionHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "orgsubscriptionhistory"})
	}

	return res, err
}

// OrganizationHistories is the resolver for the organizationHistories field.
func (r *queryResolver) OrganizationHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.OrganizationHistoryOrder, where *historygenerated.OrganizationHistoryWhereInput) (*historygenerated.OrganizationHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.OrganizationHistoryOrder{
			Field:     historygenerated.OrganizationHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).OrganizationHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "organizationhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithOrganizationHistoryOrder(orderBy),
		historygenerated.WithOrganizationHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "organizationhistory"})
	}

	return res, err
}

// OrganizationSettingHistories is the resolver for the organizationSettingHistories field.
func (r *queryResolver) OrganizationSettingHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.OrganizationSettingHistoryOrder, where *historygenerated.OrganizationSettingHistoryWhereInput) (*historygenerated.OrganizationSettingHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.OrganizationSettingHistoryOrder{
			Field:     historygenerated.OrganizationSettingHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).OrganizationSettingHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "organizationsettinghistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithOrganizationSettingHistoryOrder(orderBy),
		historygenerated.WithOrganizationSettingHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "organizationsettinghistory"})
	}

	return res, err
}

// ProcedureHistories is the resolver for the procedureHistories field.
func (r *queryResolver) ProcedureHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ProcedureHistoryOrder, where *historygenerated.ProcedureHistoryWhereInput) (*historygenerated.ProcedureHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ProcedureHistoryOrder{
			Field:     historygenerated.ProcedureHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ProcedureHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "procedurehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithProcedureHistoryOrder(orderBy),
		historygenerated.WithProcedureHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "procedurehistory"})
	}

	return res, err
}

// ProgramHistories is the resolver for the programHistories field.
func (r *queryResolver) ProgramHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ProgramHistoryOrder, where *historygenerated.ProgramHistoryWhereInput) (*historygenerated.ProgramHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ProgramHistoryOrder{
			Field:     historygenerated.ProgramHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ProgramHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "programhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithProgramHistoryOrder(orderBy),
		historygenerated.WithProgramHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "programhistory"})
	}

	return res, err
}

// ProgramMembershipHistories is the resolver for the programMembershipHistories field.
func (r *queryResolver) ProgramMembershipHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ProgramMembershipHistoryOrder, where *historygenerated.ProgramMembershipHistoryWhereInput) (*historygenerated.ProgramMembershipHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ProgramMembershipHistoryOrder{
			Field:     historygenerated.ProgramMembershipHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ProgramMembershipHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "programmembershiphistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithProgramMembershipHistoryOrder(orderBy),
		historygenerated.WithProgramMembershipHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "programmembershiphistory"})
	}

	return res, err
}

// RemediationHistories is the resolver for the remediationHistories field.
func (r *queryResolver) RemediationHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.RemediationHistoryOrder, where *historygenerated.RemediationHistoryWhereInput) (*historygenerated.RemediationHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.RemediationHistoryOrder{
			Field:     historygenerated.RemediationHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).RemediationHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "remediationhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithRemediationHistoryOrder(orderBy),
		historygenerated.WithRemediationHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "remediationhistory"})
	}

	return res, err
}

// ReviewHistories is the resolver for the reviewHistories field.
func (r *queryResolver) ReviewHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ReviewHistoryOrder, where *historygenerated.ReviewHistoryWhereInput) (*historygenerated.ReviewHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ReviewHistoryOrder{
			Field:     historygenerated.ReviewHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ReviewHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "reviewhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithReviewHistoryOrder(orderBy),
		historygenerated.WithReviewHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "reviewhistory"})
	}

	return res, err
}

// RiskHistories is the resolver for the riskHistories field.
func (r *queryResolver) RiskHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.RiskHistoryOrder, where *historygenerated.RiskHistoryWhereInput) (*historygenerated.RiskHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.RiskHistoryOrder{
			Field:     historygenerated.RiskHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).RiskHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "riskhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithRiskHistoryOrder(orderBy),
		historygenerated.WithRiskHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "riskhistory"})
	}

	return res, err
}

// ScanHistories is the resolver for the scanHistories field.
func (r *queryResolver) ScanHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ScanHistoryOrder, where *historygenerated.ScanHistoryWhereInput) (*historygenerated.ScanHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ScanHistoryOrder{
			Field:     historygenerated.ScanHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ScanHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "scanhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithScanHistoryOrder(orderBy),
		historygenerated.WithScanHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "scanhistory"})
	}

	return res, err
}

// ScheduledJobHistories is the resolver for the scheduledJobHistories field.
func (r *queryResolver) ScheduledJobHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.ScheduledJobHistoryOrder, where *historygenerated.ScheduledJobHistoryWhereInput) (*historygenerated.ScheduledJobHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.ScheduledJobHistoryOrder{
			Field:     historygenerated.ScheduledJobHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).ScheduledJobHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "scheduledjobhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithScheduledJobHistoryOrder(orderBy),
		historygenerated.WithScheduledJobHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "scheduledjobhistory"})
	}

	return res, err
}

// StandardHistories is the resolver for the standardHistories field.
func (r *queryResolver) StandardHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.StandardHistoryOrder, where *historygenerated.StandardHistoryWhereInput) (*historygenerated.StandardHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.StandardHistoryOrder{
			Field:     historygenerated.StandardHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).StandardHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "standardhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithStandardHistoryOrder(orderBy),
		historygenerated.WithStandardHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "standardhistory"})
	}

	return res, err
}

// SubcontrolHistories is the resolver for the subcontrolHistories field.
func (r *queryResolver) SubcontrolHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.SubcontrolHistoryOrder, where *historygenerated.SubcontrolHistoryWhereInput) (*historygenerated.SubcontrolHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.SubcontrolHistoryOrder{
			Field:     historygenerated.SubcontrolHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).SubcontrolHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "subcontrolhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithSubcontrolHistoryOrder(orderBy),
		historygenerated.WithSubcontrolHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "subcontrolhistory"})
	}

	return res, err
}

// SubprocessorHistories is the resolver for the subprocessorHistories field.
func (r *queryResolver) SubprocessorHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.SubprocessorHistoryOrder, where *historygenerated.SubprocessorHistoryWhereInput) (*historygenerated.SubprocessorHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.SubprocessorHistoryOrder{
			Field:     historygenerated.SubprocessorHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).SubprocessorHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "subprocessorhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithSubprocessorHistoryOrder(orderBy),
		historygenerated.WithSubprocessorHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "subprocessorhistory"})
	}

	return res, err
}

// TaskHistories is the resolver for the taskHistories field.
func (r *queryResolver) TaskHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TaskHistoryOrder, where *historygenerated.TaskHistoryWhereInput) (*historygenerated.TaskHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TaskHistoryOrder{
			Field:     historygenerated.TaskHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TaskHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "taskhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTaskHistoryOrder(orderBy),
		historygenerated.WithTaskHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "taskhistory"})
	}

	return res, err
}

// TemplateHistories is the resolver for the templateHistories field.
func (r *queryResolver) TemplateHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TemplateHistoryOrder, where *historygenerated.TemplateHistoryWhereInput) (*historygenerated.TemplateHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TemplateHistoryOrder{
			Field:     historygenerated.TemplateHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TemplateHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "templatehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTemplateHistoryOrder(orderBy),
		historygenerated.WithTemplateHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "templatehistory"})
	}

	return res, err
}

// TrustCenterComplianceHistories is the resolver for the trustCenterComplianceHistories field.
func (r *queryResolver) TrustCenterComplianceHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustCenterComplianceHistoryOrder, where *historygenerated.TrustCenterComplianceHistoryWhereInput) (*historygenerated.TrustCenterComplianceHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustCenterComplianceHistoryOrder{
			Field:     historygenerated.TrustCenterComplianceHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustCenterComplianceHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcentercompliancehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustCenterComplianceHistoryOrder(orderBy),
		historygenerated.WithTrustCenterComplianceHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcentercompliancehistory"})
	}

	return res, err
}

// TrustCenterDocHistories is the resolver for the trustCenterDocHistories field.
func (r *queryResolver) TrustCenterDocHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustCenterDocHistoryOrder, where *historygenerated.TrustCenterDocHistoryWhereInput) (*historygenerated.TrustCenterDocHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustCenterDocHistoryOrder{
			Field:     historygenerated.TrustCenterDocHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustCenterDocHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterdochistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustCenterDocHistoryOrder(orderBy),
		historygenerated.WithTrustCenterDocHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterdochistory"})
	}

	return res, err
}

// TrustCenterHistories is the resolver for the trustCenterHistories field.
func (r *queryResolver) TrustCenterHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustCenterHistoryOrder, where *historygenerated.TrustCenterHistoryWhereInput) (*historygenerated.TrustCenterHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustCenterHistoryOrder{
			Field:     historygenerated.TrustCenterHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustCenterHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustCenterHistoryOrder(orderBy),
		historygenerated.WithTrustCenterHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterhistory"})
	}

	return res, err
}

// TrustCenterSettingHistories is the resolver for the trustCenterSettingHistories field.
func (r *queryResolver) TrustCenterSettingHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustCenterSettingHistoryOrder, where *historygenerated.TrustCenterSettingHistoryWhereInput) (*historygenerated.TrustCenterSettingHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustCenterSettingHistoryOrder{
			Field:     historygenerated.TrustCenterSettingHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustCenterSettingHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcentersettinghistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustCenterSettingHistoryOrder(orderBy),
		historygenerated.WithTrustCenterSettingHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcentersettinghistory"})
	}

	return res, err
}

// TrustCenterSubprocessorHistories is the resolver for the trustCenterSubprocessorHistories field.
func (r *queryResolver) TrustCenterSubprocessorHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustCenterSubprocessorHistoryOrder, where *historygenerated.TrustCenterSubprocessorHistoryWhereInput) (*historygenerated.TrustCenterSubprocessorHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustCenterSubprocessorHistoryOrder{
			Field:     historygenerated.TrustCenterSubprocessorHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustCenterSubprocessorHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcentersubprocessorhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustCenterSubprocessorHistoryOrder(orderBy),
		historygenerated.WithTrustCenterSubprocessorHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcentersubprocessorhistory"})
	}

	return res, err
}

// TrustCenterWatermarkConfigHistories is the resolver for the trustCenterWatermarkConfigHistories field.
func (r *queryResolver) TrustCenterWatermarkConfigHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustCenterWatermarkConfigHistoryOrder, where *historygenerated.TrustCenterWatermarkConfigHistoryWhereInput) (*historygenerated.TrustCenterWatermarkConfigHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustCenterWatermarkConfigHistoryOrder{
			Field:     historygenerated.TrustCenterWatermarkConfigHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustCenterWatermarkConfigHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterwatermarkconfighistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustCenterWatermarkConfigHistoryOrder(orderBy),
		historygenerated.WithTrustCenterWatermarkConfigHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterwatermarkconfighistory"})
	}

	return res, err
}

// TrustcenterEntityHistories is the resolver for the trustcenterEntityHistories field.
func (r *queryResolver) TrustcenterEntityHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.TrustcenterEntityHistoryOrder, where *historygenerated.TrustcenterEntityHistoryWhereInput) (*historygenerated.TrustcenterEntityHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.TrustcenterEntityHistoryOrder{
			Field:     historygenerated.TrustcenterEntityHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).TrustcenterEntityHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterentityhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithTrustcenterEntityHistoryOrder(orderBy),
		historygenerated.WithTrustcenterEntityHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "trustcenterentityhistory"})
	}

	return res, err
}

// UserHistories is the resolver for the userHistories field.
func (r *queryResolver) UserHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.UserHistoryOrder, where *historygenerated.UserHistoryWhereInput) (*historygenerated.UserHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.UserHistoryOrder{
			Field:     historygenerated.UserHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).UserHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "userhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithUserHistoryOrder(orderBy),
		historygenerated.WithUserHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "userhistory"})
	}

	return res, err
}

// UserSettingHistories is the resolver for the userSettingHistories field.
func (r *queryResolver) UserSettingHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.UserSettingHistoryOrder, where *historygenerated.UserSettingHistoryWhereInput) (*historygenerated.UserSettingHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.UserSettingHistoryOrder{
			Field:     historygenerated.UserSettingHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).UserSettingHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "usersettinghistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithUserSettingHistoryOrder(orderBy),
		historygenerated.WithUserSettingHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "usersettinghistory"})
	}

	return res, err
}

// VulnerabilityHistories is the resolver for the vulnerabilityHistories field.
func (r *queryResolver) VulnerabilityHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.VulnerabilityHistoryOrder, where *historygenerated.VulnerabilityHistoryWhereInput) (*historygenerated.VulnerabilityHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.VulnerabilityHistoryOrder{
			Field:     historygenerated.VulnerabilityHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).VulnerabilityHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "vulnerabilityhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithVulnerabilityHistoryOrder(orderBy),
		historygenerated.WithVulnerabilityHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "vulnerabilityhistory"})
	}

	return res, err
}

// WorkflowAssignmentHistories is the resolver for the workflowAssignmentHistories field.
func (r *queryResolver) WorkflowAssignmentHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.WorkflowAssignmentHistoryOrder, where *historygenerated.WorkflowAssignmentHistoryWhereInput) (*historygenerated.WorkflowAssignmentHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.WorkflowAssignmentHistoryOrder{
			Field:     historygenerated.WorkflowAssignmentHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).WorkflowAssignmentHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowassignmenthistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithWorkflowAssignmentHistoryOrder(orderBy),
		historygenerated.WithWorkflowAssignmentHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowassignmenthistory"})
	}

	return res, err
}

// WorkflowAssignmentTargetHistories is the resolver for the workflowAssignmentTargetHistories field.
func (r *queryResolver) WorkflowAssignmentTargetHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.WorkflowAssignmentTargetHistoryOrder, where *historygenerated.WorkflowAssignmentTargetHistoryWhereInput) (*historygenerated.WorkflowAssignmentTargetHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.WorkflowAssignmentTargetHistoryOrder{
			Field:     historygenerated.WorkflowAssignmentTargetHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).WorkflowAssignmentTargetHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowassignmenttargethistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithWorkflowAssignmentTargetHistoryOrder(orderBy),
		historygenerated.WithWorkflowAssignmentTargetHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowassignmenttargethistory"})
	}

	return res, err
}

// WorkflowDefinitionHistories is the resolver for the workflowDefinitionHistories field.
func (r *queryResolver) WorkflowDefinitionHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.WorkflowDefinitionHistoryOrder, where *historygenerated.WorkflowDefinitionHistoryWhereInput) (*historygenerated.WorkflowDefinitionHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.WorkflowDefinitionHistoryOrder{
			Field:     historygenerated.WorkflowDefinitionHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).WorkflowDefinitionHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowdefinitionhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithWorkflowDefinitionHistoryOrder(orderBy),
		historygenerated.WithWorkflowDefinitionHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowdefinitionhistory"})
	}

	return res, err
}

// WorkflowEventHistories is the resolver for the workflowEventHistories field.
func (r *queryResolver) WorkflowEventHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.WorkflowEventHistoryOrder, where *historygenerated.WorkflowEventHistoryWhereInput) (*historygenerated.WorkflowEventHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.WorkflowEventHistoryOrder{
			Field:     historygenerated.WorkflowEventHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).WorkflowEventHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workfloweventhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithWorkflowEventHistoryOrder(orderBy),
		historygenerated.WithWorkflowEventHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workfloweventhistory"})
	}

	return res, err
}

// WorkflowInstanceHistories is the resolver for the workflowInstanceHistories field.
func (r *queryResolver) WorkflowInstanceHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.WorkflowInstanceHistoryOrder, where *historygenerated.WorkflowInstanceHistoryWhereInput) (*historygenerated.WorkflowInstanceHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.WorkflowInstanceHistoryOrder{
			Field:     historygenerated.WorkflowInstanceHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).WorkflowInstanceHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowinstancehistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithWorkflowInstanceHistoryOrder(orderBy),
		historygenerated.WithWorkflowInstanceHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowinstancehistory"})
	}

	return res, err
}

// WorkflowObjectRefHistories is the resolver for the workflowObjectRefHistories field.
func (r *queryResolver) WorkflowObjectRefHistories(ctx context.Context, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int, orderBy *historygenerated.WorkflowObjectRefHistoryOrder, where *historygenerated.WorkflowObjectRefHistoryWhereInput) (*historygenerated.WorkflowObjectRefHistoryConnection, error) {
	// set page limit if nothing was set
	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	if orderBy == nil {
		orderBy = &historygenerated.WorkflowObjectRefHistoryOrder{
			Field:     historygenerated.WorkflowObjectRefHistoryOrderFieldCreatedAt,
			Direction: entgql.OrderDirectionDesc,
		}
	}

	query, err := withTransactionalMutation(ctx).WorkflowObjectRefHistory.Query().CollectFields(ctx)
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowobjectrefhistory"})
	}

	res, err := query.Paginate(
		ctx,
		after,
		first,
		before,
		last,
		historygenerated.WithWorkflowObjectRefHistoryOrder(orderBy),
		historygenerated.WithWorkflowObjectRefHistoryFilter(where.Filter))
	if err != nil {
		return nil, parseRequestError(ctx, err, common.Action{Action: common.ActionGet, Object: "workflowobjectrefhistory"})
	}

	return res, err
}

// TestingProcedures is the resolver for the testingProcedures field.
func (r *subcontrolHistoryResolver) TestingProcedures(ctx context.Context, obj *historygenerated.SubcontrolHistory) ([]string, error) {
	panic(fmt.Errorf("not implemented: TestingProcedures - testingProcedures"))
}

// EvidenceRequests is the resolver for the evidenceRequests field.
func (r *subcontrolHistoryResolver) EvidenceRequests(ctx context.Context, obj *historygenerated.SubcontrolHistory) ([]string, error) {
	panic(fmt.Errorf("not implemented: EvidenceRequests - evidenceRequests"))
}

// ControlHistory returns gqlhistorygenerated.ControlHistoryResolver implementation.
func (r *Resolver) ControlHistory() gqlhistorygenerated.ControlHistoryResolver {
	return &controlHistoryResolver{r}
}

// Query returns gqlhistorygenerated.QueryResolver implementation.
func (r *Resolver) Query() gqlhistorygenerated.QueryResolver { return &queryResolver{r} }

// SubcontrolHistory returns gqlhistorygenerated.SubcontrolHistoryResolver implementation.
func (r *Resolver) SubcontrolHistory() gqlhistorygenerated.SubcontrolHistoryResolver {
	return &subcontrolHistoryResolver{r}
}

type controlHistoryResolver struct{ *Resolver }
type queryResolver struct{ *Resolver }
type subcontrolHistoryResolver struct{ *Resolver }
