mutation CloneBulkCSVControl($input: Upload!) {
  cloneBulkCSVControl(input: $input) {
    controls {
      assessmentMethods
      assessmentObjectives
      category
      categoryID
      controlQuestions
      controlType
      createdAt
      createdBy
      description
      displayID
      exampleEvidence
      id
      implementationGuidance
      mappedCategories
      ownerID
      refCode
      references
      referenceFramework
      referenceFrameworkRevision
      referenceID
      source
      standardID
      status
      subcategory
      tags
      title
      updatedAt
      updatedBy
      comments {
        edges {
          node {
            id
            text
          }
        }
      }
      controlImplementations {
        edges {
          node {
            id
            details
          }
        }
      }
      subcontrols {
        edges {
          node {
            id
            refCode
            title
          }
        }
      }
    }
  }
}

mutation CreateControlsByClone($input: CloneControlInput!) {
  createControlsByClone(input: $input) {
    controls {
      assessmentMethods
      assessmentObjectives
      category
      categoryID
      controlQuestions
      controlType
      createdAt
      createdBy
      description
      displayID
      exampleEvidence
      id
      implementationGuidance
      mappedCategories
      ownerID
      refCode
      references
      referenceFramework
      referenceFrameworkRevision
      source
      standardID
      status
      subcategory
      title
      tags
      updatedAt
      updatedBy
      subcontrols {
        edges {
          node {
            id
            refCode
            title
          }
        }
      }
      programs {
        edges {
          node {
            id
            displayID
            name
          }
        }
      }
    }
  }
}

mutation CreateControlsByCloneReturnID($input: CloneControlInput!) {
  createControlsByClone(input: $input) {
    controls {
      id
    }
  }
}

query GetControlCategories {
  controlCategories
}

query GetControlCategoriesWithFramework($where: ControlWhereInput) {
  controlCategoriesByFramework(where: $where) {
    node {
      name
      referenceFramework
    }
  }
}

query GetControlsGroupByCategory($first: Int, $last: Int, $after: Cursor, $before: Cursor, $where: ControlWhereInput, $orderBy: [ControlOrder!], $category: String) {
  controlsGroupByCategory(
    first: $first
    last: $last
    after: $after
    before: $before
    where: $where
    orderBy: $orderBy
    category: $category
  ) {
    edges {
      node {
        category
        controls {
          edges {
            node {
              id
              refCode
              referenceFramework
              ownerID
            }
          }
          totalCount
          pageInfo {
            endCursor
            hasNextPage
            hasPreviousPage
            startCursor
          }
        }
      }
    }
  }
}

query GetControlSubcategories {
  controlSubcategories
}

query GetControlSubcategoriesWithFramework($where: ControlWhereInput) {
  controlSubcategoriesByFramework(where: $where) {
    node {
      name
      referenceFramework
    }
  }
}

mutation UpdateControlComment($updateControlCommentId: ID!, $input: UpdateNoteInput!) {
  updateControlComment(id: $updateControlCommentId, input: $input) {
    control {
      id
      comments {
        edges {
          node {
            id
            text
            textJSON
          }
        }
      }
      discussions {
        edges {
          node {
            id
            comments {
              edges {
                node {
                  id
                  text
                  textJSON
                }
              }
            }
          }
        }
      }
    }
  }
}
