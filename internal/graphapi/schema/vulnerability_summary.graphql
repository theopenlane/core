"""
Summary bucket for vulnerability groupings.
"""
type VulnerabilitySummaryBucket {
  """
  Bucket label such as severity or source.
  """
  key: String!
  """
  Count of vulnerabilities in this bucket.
  """
  count: Int!
}

"""
Aggregated vulnerability summary for dashboards.
"""
type VulnerabilitySummary {
  """
  Total vulnerabilities matching the filter.
  """
  total: Int!
  """
  Counts grouped by severity.
  """
  bySeverity: [VulnerabilitySummaryBucket!]!
  """
  Counts grouped by source.
  """
  bySource: [VulnerabilitySummaryBucket!]!
  """
  Counts grouped by status.
  """
  byStatus: [VulnerabilitySummaryBucket!]!
}

extend type Query {
  """
  Aggregate vulnerability counts for dashboards.
  """
  vulnerabilitySummary(
    """
    Filtering options for vulnerabilities included in the summary.
    """
    where: VulnerabilityWhereInput
  ): VulnerabilitySummary!
}
