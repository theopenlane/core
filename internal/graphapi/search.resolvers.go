package graphapi

// THIS CODE IS REGENERATED BY github.com/theopenlane/gqlgen-plugins. DO NOT EDIT.

import (
	"context"

	"entgo.io/contrib/entgql"
	"github.com/theopenlane/core/internal/ent/generated"
	"github.com/theopenlane/core/internal/graphapi/common"
	"github.com/theopenlane/core/internal/graphapi/model"
	"github.com/theopenlane/core/pkg/logx"
	"github.com/theopenlane/gqlgen-plugins/graphutils"
)

// Search is the resolver for the search field.
func (r *queryResolver) Search(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*model.SearchResults, error) {
	if len(query) < 3 {
		return nil, common.ErrSearchQueryTooShort
	}

	first, last = graphutils.SetFirstLastDefaults(first, last, r.maxResultLimit)

	var (
		errors                    []error
		actionplanResults         *generated.ActionPlanConnection
		assessmentResults         *generated.AssessmentConnection
		assessmentresponseResults *generated.AssessmentResponseConnection
		assetResults              *generated.AssetConnection
		contactResults            *generated.ContactConnection
		controlResults            *generated.ControlConnection
		controlobjectiveResults   *generated.ControlObjectiveConnection
		customtypeenumResults     *generated.CustomTypeEnumConnection
		entityResults             *generated.EntityConnection
		evidenceResults           *generated.EvidenceConnection
		findingResults            *generated.FindingConnection
		groupResults              *generated.GroupConnection
		internalpolicyResults     *generated.InternalPolicyConnection
		inviteResults             *generated.InviteConnection
		jobrunnerResults          *generated.JobRunnerConnection
		jobtemplateResults        *generated.JobTemplateConnection
		narrativeResults          *generated.NarrativeConnection
		organizationResults       *generated.OrganizationConnection
		procedureResults          *generated.ProcedureConnection
		programResults            *generated.ProgramConnection
		remediationResults        *generated.RemediationConnection
		reviewResults             *generated.ReviewConnection
		riskResults               *generated.RiskConnection
		scanResults               *generated.ScanConnection
		standardResults           *generated.StandardConnection
		subcontrolResults         *generated.SubcontrolConnection
		subprocessorResults       *generated.SubprocessorConnection
		subscriberResults         *generated.SubscriberConnection
		tagdefinitionResults      *generated.TagDefinitionConnection
		taskResults               *generated.TaskConnection
		templateResults           *generated.TemplateConnection
		trustcenterentityResults  *generated.TrustCenterEntityConnection
		vulnerabilityResults      *generated.VulnerabilityConnection
	)

	highlightTracker := newContextTracker(query)

	hasSearchContext := graphutils.CheckForRequestedField(ctx, "searchContext")

	if err := r.withPool().SubmitMultipleAndWait([]func(){
		func() {
			var err error
			actionplanResults, err = searchActionPlans(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, actionplanResults, highlightTracker)
			}
		},
		func() {
			var err error
			assessmentResults, err = searchAssessments(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, assessmentResults, highlightTracker)
			}
		},
		func() {
			var err error
			assessmentresponseResults, err = searchAssessmentResponses(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, assessmentresponseResults, highlightTracker)
			}
		},
		func() {
			var err error
			assetResults, err = searchAssets(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, assetResults, highlightTracker)
			}
		},
		func() {
			var err error
			contactResults, err = searchContacts(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, contactResults, highlightTracker)
			}
		},
		func() {
			var err error
			controlResults, err = searchControls(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, controlResults, highlightTracker)
			}
		},
		func() {
			var err error
			controlobjectiveResults, err = searchControlObjectives(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, controlobjectiveResults, highlightTracker)
			}
		},
		func() {
			var err error
			customtypeenumResults, err = searchCustomTypeEnums(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, customtypeenumResults, highlightTracker)
			}
		},
		func() {
			var err error
			entityResults, err = searchEntities(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, entityResults, highlightTracker)
			}
		},
		func() {
			var err error
			evidenceResults, err = searchEvidences(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, evidenceResults, highlightTracker)
			}
		},
		func() {
			var err error
			findingResults, err = searchFindings(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, findingResults, highlightTracker)
			}
		},
		func() {
			var err error
			groupResults, err = searchGroups(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, groupResults, highlightTracker)
			}
		},
		func() {
			var err error
			internalpolicyResults, err = searchInternalPolicies(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, internalpolicyResults, highlightTracker)
			}
		},
		func() {
			var err error
			inviteResults, err = searchInvites(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, inviteResults, highlightTracker)
			}
		},
		func() {
			var err error
			jobrunnerResults, err = searchJobRunners(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, jobrunnerResults, highlightTracker)
			}
		},
		func() {
			var err error
			jobtemplateResults, err = searchJobTemplates(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, jobtemplateResults, highlightTracker)
			}
		},
		func() {
			var err error
			narrativeResults, err = searchNarratives(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, narrativeResults, highlightTracker)
			}
		},
		func() {
			var err error
			organizationResults, err = searchOrganizations(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, organizationResults, highlightTracker)
			}
		},
		func() {
			var err error
			procedureResults, err = searchProcedures(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, procedureResults, highlightTracker)
			}
		},
		func() {
			var err error
			programResults, err = searchPrograms(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, programResults, highlightTracker)
			}
		},
		func() {
			var err error
			remediationResults, err = searchRemediations(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, remediationResults, highlightTracker)
			}
		},
		func() {
			var err error
			reviewResults, err = searchReviews(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, reviewResults, highlightTracker)
			}
		},
		func() {
			var err error
			riskResults, err = searchRisks(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, riskResults, highlightTracker)
			}
		},
		func() {
			var err error
			scanResults, err = searchScans(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, scanResults, highlightTracker)
			}
		},
		func() {
			var err error
			standardResults, err = searchStandards(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, standardResults, highlightTracker)
			}
		},
		func() {
			var err error
			subcontrolResults, err = searchSubcontrols(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, subcontrolResults, highlightTracker)
			}
		},
		func() {
			var err error
			subprocessorResults, err = searchSubprocessors(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, subprocessorResults, highlightTracker)
			}
		},
		func() {
			var err error
			subscriberResults, err = searchSubscribers(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, subscriberResults, highlightTracker)
			}
		},
		func() {
			var err error
			tagdefinitionResults, err = searchTagDefinitions(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, tagdefinitionResults, highlightTracker)
			}
		},
		func() {
			var err error
			taskResults, err = searchTasks(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, taskResults, highlightTracker)
			}
		},
		func() {
			var err error
			templateResults, err = searchTemplates(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, templateResults, highlightTracker)
			}
		},
		func() {
			var err error
			trustcenterentityResults, err = searchTrustCenterEntities(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, trustcenterentityResults, highlightTracker)
			}
		},
		func() {
			var err error
			vulnerabilityResults, err = searchVulnerabilities(ctx, query, after, first, before, last)
			// ignore not found errors
			if err != nil && !generated.IsNotFound(err) {
				errors = append(errors, err)
			}

			if hasSearchContext {
				highlightSearchContext(ctx, query, vulnerabilityResults, highlightTracker)
			}
		},
	}); err != nil {
		return nil, err
	}

	// log the errors for debugging
	if len(errors) > 0 {
		logx.FromContext(ctx).Error().Errs("errors", errors).Msg("search failed for one or more entities")
	}

	// return the results
	res := &model.SearchResults{
		TotalCount:    0,
		SearchContext: highlightTracker.getContexts(),
	}
	if actionplanResults != nil && len(actionplanResults.Edges) > 0 {
		res.ActionPlans = actionplanResults

		res.TotalCount += actionplanResults.TotalCount
	}
	if assessmentResults != nil && len(assessmentResults.Edges) > 0 {
		res.Assessments = assessmentResults

		res.TotalCount += assessmentResults.TotalCount
	}
	if assessmentresponseResults != nil && len(assessmentresponseResults.Edges) > 0 {
		res.AssessmentResponses = assessmentresponseResults

		res.TotalCount += assessmentresponseResults.TotalCount
	}
	if assetResults != nil && len(assetResults.Edges) > 0 {
		res.Assets = assetResults

		res.TotalCount += assetResults.TotalCount
	}
	if contactResults != nil && len(contactResults.Edges) > 0 {
		res.Contacts = contactResults

		res.TotalCount += contactResults.TotalCount
	}
	if controlResults != nil && len(controlResults.Edges) > 0 {
		res.Controls = controlResults

		res.TotalCount += controlResults.TotalCount
	}
	if controlobjectiveResults != nil && len(controlobjectiveResults.Edges) > 0 {
		res.ControlObjectives = controlobjectiveResults

		res.TotalCount += controlobjectiveResults.TotalCount
	}
	if customtypeenumResults != nil && len(customtypeenumResults.Edges) > 0 {
		res.CustomTypeEnums = customtypeenumResults

		res.TotalCount += customtypeenumResults.TotalCount
	}
	if entityResults != nil && len(entityResults.Edges) > 0 {
		res.Entities = entityResults

		res.TotalCount += entityResults.TotalCount
	}
	if evidenceResults != nil && len(evidenceResults.Edges) > 0 {
		res.Evidences = evidenceResults

		res.TotalCount += evidenceResults.TotalCount
	}
	if findingResults != nil && len(findingResults.Edges) > 0 {
		res.Findings = findingResults

		res.TotalCount += findingResults.TotalCount
	}
	if groupResults != nil && len(groupResults.Edges) > 0 {
		res.Groups = groupResults

		res.TotalCount += groupResults.TotalCount
	}
	if internalpolicyResults != nil && len(internalpolicyResults.Edges) > 0 {
		res.InternalPolicies = internalpolicyResults

		res.TotalCount += internalpolicyResults.TotalCount
	}
	if inviteResults != nil && len(inviteResults.Edges) > 0 {
		res.Invites = inviteResults

		res.TotalCount += inviteResults.TotalCount
	}
	if jobrunnerResults != nil && len(jobrunnerResults.Edges) > 0 {
		res.JobRunners = jobrunnerResults

		res.TotalCount += jobrunnerResults.TotalCount
	}
	if jobtemplateResults != nil && len(jobtemplateResults.Edges) > 0 {
		res.JobTemplates = jobtemplateResults

		res.TotalCount += jobtemplateResults.TotalCount
	}
	if narrativeResults != nil && len(narrativeResults.Edges) > 0 {
		res.Narratives = narrativeResults

		res.TotalCount += narrativeResults.TotalCount
	}
	if organizationResults != nil && len(organizationResults.Edges) > 0 {
		res.Organizations = organizationResults

		res.TotalCount += organizationResults.TotalCount
	}
	if procedureResults != nil && len(procedureResults.Edges) > 0 {
		res.Procedures = procedureResults

		res.TotalCount += procedureResults.TotalCount
	}
	if programResults != nil && len(programResults.Edges) > 0 {
		res.Programs = programResults

		res.TotalCount += programResults.TotalCount
	}
	if remediationResults != nil && len(remediationResults.Edges) > 0 {
		res.Remediations = remediationResults

		res.TotalCount += remediationResults.TotalCount
	}
	if reviewResults != nil && len(reviewResults.Edges) > 0 {
		res.Reviews = reviewResults

		res.TotalCount += reviewResults.TotalCount
	}
	if riskResults != nil && len(riskResults.Edges) > 0 {
		res.Risks = riskResults

		res.TotalCount += riskResults.TotalCount
	}
	if scanResults != nil && len(scanResults.Edges) > 0 {
		res.Scans = scanResults

		res.TotalCount += scanResults.TotalCount
	}
	if standardResults != nil && len(standardResults.Edges) > 0 {
		res.Standards = standardResults

		res.TotalCount += standardResults.TotalCount
	}
	if subcontrolResults != nil && len(subcontrolResults.Edges) > 0 {
		res.Subcontrols = subcontrolResults

		res.TotalCount += subcontrolResults.TotalCount
	}
	if subprocessorResults != nil && len(subprocessorResults.Edges) > 0 {
		res.Subprocessors = subprocessorResults

		res.TotalCount += subprocessorResults.TotalCount
	}
	if subscriberResults != nil && len(subscriberResults.Edges) > 0 {
		res.Subscribers = subscriberResults

		res.TotalCount += subscriberResults.TotalCount
	}
	if tagdefinitionResults != nil && len(tagdefinitionResults.Edges) > 0 {
		res.TagDefinitions = tagdefinitionResults

		res.TotalCount += tagdefinitionResults.TotalCount
	}
	if taskResults != nil && len(taskResults.Edges) > 0 {
		res.Tasks = taskResults

		res.TotalCount += taskResults.TotalCount
	}
	if templateResults != nil && len(templateResults.Edges) > 0 {
		res.Templates = templateResults

		res.TotalCount += templateResults.TotalCount
	}
	if trustcenterentityResults != nil && len(trustcenterentityResults.Edges) > 0 {
		res.TrustCenterEntities = trustcenterentityResults

		res.TotalCount += trustcenterentityResults.TotalCount
	}
	if vulnerabilityResults != nil && len(vulnerabilityResults.Edges) > 0 {
		res.Vulnerabilities = vulnerabilityResults

		res.TotalCount += vulnerabilityResults.TotalCount
	}

	return res, nil
}
func (r *queryResolver) ActionPlanSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ActionPlanConnection, error) {
	actionplanResults, err := searchActionPlans(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return actionplanResults, nil
}
func (r *queryResolver) AssessmentSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.AssessmentConnection, error) {
	assessmentResults, err := searchAssessments(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return assessmentResults, nil
}
func (r *queryResolver) AssessmentResponseSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.AssessmentResponseConnection, error) {
	assessmentresponseResults, err := searchAssessmentResponses(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return assessmentresponseResults, nil
}
func (r *queryResolver) AssetSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.AssetConnection, error) {
	assetResults, err := searchAssets(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return assetResults, nil
}
func (r *queryResolver) ContactSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ContactConnection, error) {
	contactResults, err := searchContacts(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return contactResults, nil
}
func (r *queryResolver) ControlSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ControlConnection, error) {
	controlResults, err := searchControls(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return controlResults, nil
}
func (r *queryResolver) ControlObjectiveSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ControlObjectiveConnection, error) {
	controlobjectiveResults, err := searchControlObjectives(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return controlobjectiveResults, nil
}
func (r *queryResolver) CustomTypeEnumSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.CustomTypeEnumConnection, error) {
	customtypeenumResults, err := searchCustomTypeEnums(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return customtypeenumResults, nil
}
func (r *queryResolver) EntitySearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.EntityConnection, error) {
	entityResults, err := searchEntities(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return entityResults, nil
}
func (r *queryResolver) EvidenceSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.EvidenceConnection, error) {
	evidenceResults, err := searchEvidences(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return evidenceResults, nil
}
func (r *queryResolver) FindingSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.FindingConnection, error) {
	findingResults, err := searchFindings(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return findingResults, nil
}
func (r *queryResolver) GroupSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.GroupConnection, error) {
	groupResults, err := searchGroups(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return groupResults, nil
}
func (r *queryResolver) InternalPolicySearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.InternalPolicyConnection, error) {
	internalpolicyResults, err := searchInternalPolicies(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return internalpolicyResults, nil
}
func (r *queryResolver) InviteSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.InviteConnection, error) {
	inviteResults, err := searchInvites(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return inviteResults, nil
}
func (r *queryResolver) JobRunnerSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.JobRunnerConnection, error) {
	jobrunnerResults, err := searchJobRunners(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return jobrunnerResults, nil
}
func (r *queryResolver) JobTemplateSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.JobTemplateConnection, error) {
	jobtemplateResults, err := searchJobTemplates(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return jobtemplateResults, nil
}
func (r *queryResolver) NarrativeSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.NarrativeConnection, error) {
	narrativeResults, err := searchNarratives(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return narrativeResults, nil
}
func (r *queryResolver) OrganizationSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.OrganizationConnection, error) {
	organizationResults, err := searchOrganizations(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return organizationResults, nil
}
func (r *queryResolver) ProcedureSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ProcedureConnection, error) {
	procedureResults, err := searchProcedures(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return procedureResults, nil
}
func (r *queryResolver) ProgramSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ProgramConnection, error) {
	programResults, err := searchPrograms(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return programResults, nil
}
func (r *queryResolver) RemediationSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.RemediationConnection, error) {
	remediationResults, err := searchRemediations(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return remediationResults, nil
}
func (r *queryResolver) ReviewSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ReviewConnection, error) {
	reviewResults, err := searchReviews(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return reviewResults, nil
}
func (r *queryResolver) RiskSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.RiskConnection, error) {
	riskResults, err := searchRisks(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return riskResults, nil
}
func (r *queryResolver) ScanSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.ScanConnection, error) {
	scanResults, err := searchScans(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return scanResults, nil
}
func (r *queryResolver) StandardSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.StandardConnection, error) {
	standardResults, err := searchStandards(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return standardResults, nil
}
func (r *queryResolver) SubcontrolSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.SubcontrolConnection, error) {
	subcontrolResults, err := searchSubcontrols(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return subcontrolResults, nil
}
func (r *queryResolver) SubprocessorSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.SubprocessorConnection, error) {
	subprocessorResults, err := searchSubprocessors(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return subprocessorResults, nil
}
func (r *queryResolver) SubscriberSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.SubscriberConnection, error) {
	subscriberResults, err := searchSubscribers(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return subscriberResults, nil
}
func (r *queryResolver) TagDefinitionSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.TagDefinitionConnection, error) {
	tagdefinitionResults, err := searchTagDefinitions(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return tagdefinitionResults, nil
}
func (r *queryResolver) TaskSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.TaskConnection, error) {
	taskResults, err := searchTasks(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return taskResults, nil
}
func (r *queryResolver) TemplateSearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.TemplateConnection, error) {
	templateResults, err := searchTemplates(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return templateResults, nil
}
func (r *queryResolver) TrustCenterEntitySearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.TrustCenterEntityConnection, error) {
	trustcenterentityResults, err := searchTrustCenterEntities(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return trustcenterentityResults, nil
}
func (r *queryResolver) VulnerabilitySearch(ctx context.Context, query string, after *entgql.Cursor[string], first *int, before *entgql.Cursor[string], last *int) (*generated.VulnerabilityConnection, error) {
	vulnerabilityResults, err := searchVulnerabilities(ctx, query, after, first, before, last)

	if err != nil {
		return nil, common.ErrSearchFailed
	}

	// return the results
	return vulnerabilityResults, nil
}
