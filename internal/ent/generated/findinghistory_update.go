// Code generated by entc, DO NOT EDIT.

package generated

import (
	"context"
	"errors"
	"fmt"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/dialect/sql/sqljson"
	"entgo.io/ent/schema/field"
	"github.com/theopenlane/core/internal/ent/generated/findinghistory"
	"github.com/theopenlane/core/internal/ent/generated/predicate"
	"github.com/theopenlane/core/pkg/models"

	"github.com/theopenlane/core/internal/ent/generated/internal"
)

// FindingHistoryUpdate is the builder for updating FindingHistory entities.
type FindingHistoryUpdate struct {
	config
	hooks     []Hook
	mutation  *FindingHistoryMutation
	modifiers []func(*sql.UpdateBuilder)
}

// Where appends a list predicates to the FindingHistoryUpdate builder.
func (_u *FindingHistoryUpdate) Where(ps ...predicate.FindingHistory) *FindingHistoryUpdate {
	_u.mutation.Where(ps...)
	return _u
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *FindingHistoryUpdate) SetUpdatedAt(v time.Time) *FindingHistoryUpdate {
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// ClearUpdatedAt clears the value of the "updated_at" field.
func (_u *FindingHistoryUpdate) ClearUpdatedAt() *FindingHistoryUpdate {
	_u.mutation.ClearUpdatedAt()
	return _u
}

// SetUpdatedBy sets the "updated_by" field.
func (_u *FindingHistoryUpdate) SetUpdatedBy(v string) *FindingHistoryUpdate {
	_u.mutation.SetUpdatedBy(v)
	return _u
}

// SetNillableUpdatedBy sets the "updated_by" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableUpdatedBy(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetUpdatedBy(*v)
	}
	return _u
}

// ClearUpdatedBy clears the value of the "updated_by" field.
func (_u *FindingHistoryUpdate) ClearUpdatedBy() *FindingHistoryUpdate {
	_u.mutation.ClearUpdatedBy()
	return _u
}

// SetDeletedAt sets the "deleted_at" field.
func (_u *FindingHistoryUpdate) SetDeletedAt(v time.Time) *FindingHistoryUpdate {
	_u.mutation.SetDeletedAt(v)
	return _u
}

// SetNillableDeletedAt sets the "deleted_at" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableDeletedAt(v *time.Time) *FindingHistoryUpdate {
	if v != nil {
		_u.SetDeletedAt(*v)
	}
	return _u
}

// ClearDeletedAt clears the value of the "deleted_at" field.
func (_u *FindingHistoryUpdate) ClearDeletedAt() *FindingHistoryUpdate {
	_u.mutation.ClearDeletedAt()
	return _u
}

// SetDeletedBy sets the "deleted_by" field.
func (_u *FindingHistoryUpdate) SetDeletedBy(v string) *FindingHistoryUpdate {
	_u.mutation.SetDeletedBy(v)
	return _u
}

// SetNillableDeletedBy sets the "deleted_by" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableDeletedBy(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetDeletedBy(*v)
	}
	return _u
}

// ClearDeletedBy clears the value of the "deleted_by" field.
func (_u *FindingHistoryUpdate) ClearDeletedBy() *FindingHistoryUpdate {
	_u.mutation.ClearDeletedBy()
	return _u
}

// SetTags sets the "tags" field.
func (_u *FindingHistoryUpdate) SetTags(v []string) *FindingHistoryUpdate {
	_u.mutation.SetTags(v)
	return _u
}

// AppendTags appends value to the "tags" field.
func (_u *FindingHistoryUpdate) AppendTags(v []string) *FindingHistoryUpdate {
	_u.mutation.AppendTags(v)
	return _u
}

// ClearTags clears the value of the "tags" field.
func (_u *FindingHistoryUpdate) ClearTags() *FindingHistoryUpdate {
	_u.mutation.ClearTags()
	return _u
}

// SetInternalNotes sets the "internal_notes" field.
func (_u *FindingHistoryUpdate) SetInternalNotes(v string) *FindingHistoryUpdate {
	_u.mutation.SetInternalNotes(v)
	return _u
}

// SetNillableInternalNotes sets the "internal_notes" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableInternalNotes(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetInternalNotes(*v)
	}
	return _u
}

// ClearInternalNotes clears the value of the "internal_notes" field.
func (_u *FindingHistoryUpdate) ClearInternalNotes() *FindingHistoryUpdate {
	_u.mutation.ClearInternalNotes()
	return _u
}

// SetSystemInternalID sets the "system_internal_id" field.
func (_u *FindingHistoryUpdate) SetSystemInternalID(v string) *FindingHistoryUpdate {
	_u.mutation.SetSystemInternalID(v)
	return _u
}

// SetNillableSystemInternalID sets the "system_internal_id" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableSystemInternalID(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetSystemInternalID(*v)
	}
	return _u
}

// ClearSystemInternalID clears the value of the "system_internal_id" field.
func (_u *FindingHistoryUpdate) ClearSystemInternalID() *FindingHistoryUpdate {
	_u.mutation.ClearSystemInternalID()
	return _u
}

// SetExternalID sets the "external_id" field.
func (_u *FindingHistoryUpdate) SetExternalID(v string) *FindingHistoryUpdate {
	_u.mutation.SetExternalID(v)
	return _u
}

// SetNillableExternalID sets the "external_id" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableExternalID(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetExternalID(*v)
	}
	return _u
}

// ClearExternalID clears the value of the "external_id" field.
func (_u *FindingHistoryUpdate) ClearExternalID() *FindingHistoryUpdate {
	_u.mutation.ClearExternalID()
	return _u
}

// SetExternalOwnerID sets the "external_owner_id" field.
func (_u *FindingHistoryUpdate) SetExternalOwnerID(v string) *FindingHistoryUpdate {
	_u.mutation.SetExternalOwnerID(v)
	return _u
}

// SetNillableExternalOwnerID sets the "external_owner_id" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableExternalOwnerID(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetExternalOwnerID(*v)
	}
	return _u
}

// ClearExternalOwnerID clears the value of the "external_owner_id" field.
func (_u *FindingHistoryUpdate) ClearExternalOwnerID() *FindingHistoryUpdate {
	_u.mutation.ClearExternalOwnerID()
	return _u
}

// SetSource sets the "source" field.
func (_u *FindingHistoryUpdate) SetSource(v string) *FindingHistoryUpdate {
	_u.mutation.SetSource(v)
	return _u
}

// SetNillableSource sets the "source" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableSource(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetSource(*v)
	}
	return _u
}

// ClearSource clears the value of the "source" field.
func (_u *FindingHistoryUpdate) ClearSource() *FindingHistoryUpdate {
	_u.mutation.ClearSource()
	return _u
}

// SetResourceName sets the "resource_name" field.
func (_u *FindingHistoryUpdate) SetResourceName(v string) *FindingHistoryUpdate {
	_u.mutation.SetResourceName(v)
	return _u
}

// SetNillableResourceName sets the "resource_name" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableResourceName(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetResourceName(*v)
	}
	return _u
}

// ClearResourceName clears the value of the "resource_name" field.
func (_u *FindingHistoryUpdate) ClearResourceName() *FindingHistoryUpdate {
	_u.mutation.ClearResourceName()
	return _u
}

// SetDisplayName sets the "display_name" field.
func (_u *FindingHistoryUpdate) SetDisplayName(v string) *FindingHistoryUpdate {
	_u.mutation.SetDisplayName(v)
	return _u
}

// SetNillableDisplayName sets the "display_name" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableDisplayName(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetDisplayName(*v)
	}
	return _u
}

// ClearDisplayName clears the value of the "display_name" field.
func (_u *FindingHistoryUpdate) ClearDisplayName() *FindingHistoryUpdate {
	_u.mutation.ClearDisplayName()
	return _u
}

// SetState sets the "state" field.
func (_u *FindingHistoryUpdate) SetState(v string) *FindingHistoryUpdate {
	_u.mutation.SetState(v)
	return _u
}

// SetNillableState sets the "state" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableState(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetState(*v)
	}
	return _u
}

// ClearState clears the value of the "state" field.
func (_u *FindingHistoryUpdate) ClearState() *FindingHistoryUpdate {
	_u.mutation.ClearState()
	return _u
}

// SetCategory sets the "category" field.
func (_u *FindingHistoryUpdate) SetCategory(v string) *FindingHistoryUpdate {
	_u.mutation.SetCategory(v)
	return _u
}

// SetNillableCategory sets the "category" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableCategory(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetCategory(*v)
	}
	return _u
}

// ClearCategory clears the value of the "category" field.
func (_u *FindingHistoryUpdate) ClearCategory() *FindingHistoryUpdate {
	_u.mutation.ClearCategory()
	return _u
}

// SetCategories sets the "categories" field.
func (_u *FindingHistoryUpdate) SetCategories(v []string) *FindingHistoryUpdate {
	_u.mutation.SetCategories(v)
	return _u
}

// AppendCategories appends value to the "categories" field.
func (_u *FindingHistoryUpdate) AppendCategories(v []string) *FindingHistoryUpdate {
	_u.mutation.AppendCategories(v)
	return _u
}

// ClearCategories clears the value of the "categories" field.
func (_u *FindingHistoryUpdate) ClearCategories() *FindingHistoryUpdate {
	_u.mutation.ClearCategories()
	return _u
}

// SetFindingClass sets the "finding_class" field.
func (_u *FindingHistoryUpdate) SetFindingClass(v string) *FindingHistoryUpdate {
	_u.mutation.SetFindingClass(v)
	return _u
}

// SetNillableFindingClass sets the "finding_class" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableFindingClass(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetFindingClass(*v)
	}
	return _u
}

// ClearFindingClass clears the value of the "finding_class" field.
func (_u *FindingHistoryUpdate) ClearFindingClass() *FindingHistoryUpdate {
	_u.mutation.ClearFindingClass()
	return _u
}

// SetSeverity sets the "severity" field.
func (_u *FindingHistoryUpdate) SetSeverity(v string) *FindingHistoryUpdate {
	_u.mutation.SetSeverity(v)
	return _u
}

// SetNillableSeverity sets the "severity" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableSeverity(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetSeverity(*v)
	}
	return _u
}

// ClearSeverity clears the value of the "severity" field.
func (_u *FindingHistoryUpdate) ClearSeverity() *FindingHistoryUpdate {
	_u.mutation.ClearSeverity()
	return _u
}

// SetNumericSeverity sets the "numeric_severity" field.
func (_u *FindingHistoryUpdate) SetNumericSeverity(v float64) *FindingHistoryUpdate {
	_u.mutation.ResetNumericSeverity()
	_u.mutation.SetNumericSeverity(v)
	return _u
}

// SetNillableNumericSeverity sets the "numeric_severity" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableNumericSeverity(v *float64) *FindingHistoryUpdate {
	if v != nil {
		_u.SetNumericSeverity(*v)
	}
	return _u
}

// AddNumericSeverity adds value to the "numeric_severity" field.
func (_u *FindingHistoryUpdate) AddNumericSeverity(v float64) *FindingHistoryUpdate {
	_u.mutation.AddNumericSeverity(v)
	return _u
}

// ClearNumericSeverity clears the value of the "numeric_severity" field.
func (_u *FindingHistoryUpdate) ClearNumericSeverity() *FindingHistoryUpdate {
	_u.mutation.ClearNumericSeverity()
	return _u
}

// SetScore sets the "score" field.
func (_u *FindingHistoryUpdate) SetScore(v float64) *FindingHistoryUpdate {
	_u.mutation.ResetScore()
	_u.mutation.SetScore(v)
	return _u
}

// SetNillableScore sets the "score" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableScore(v *float64) *FindingHistoryUpdate {
	if v != nil {
		_u.SetScore(*v)
	}
	return _u
}

// AddScore adds value to the "score" field.
func (_u *FindingHistoryUpdate) AddScore(v float64) *FindingHistoryUpdate {
	_u.mutation.AddScore(v)
	return _u
}

// ClearScore clears the value of the "score" field.
func (_u *FindingHistoryUpdate) ClearScore() *FindingHistoryUpdate {
	_u.mutation.ClearScore()
	return _u
}

// SetImpact sets the "impact" field.
func (_u *FindingHistoryUpdate) SetImpact(v float64) *FindingHistoryUpdate {
	_u.mutation.ResetImpact()
	_u.mutation.SetImpact(v)
	return _u
}

// SetNillableImpact sets the "impact" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableImpact(v *float64) *FindingHistoryUpdate {
	if v != nil {
		_u.SetImpact(*v)
	}
	return _u
}

// AddImpact adds value to the "impact" field.
func (_u *FindingHistoryUpdate) AddImpact(v float64) *FindingHistoryUpdate {
	_u.mutation.AddImpact(v)
	return _u
}

// ClearImpact clears the value of the "impact" field.
func (_u *FindingHistoryUpdate) ClearImpact() *FindingHistoryUpdate {
	_u.mutation.ClearImpact()
	return _u
}

// SetExploitability sets the "exploitability" field.
func (_u *FindingHistoryUpdate) SetExploitability(v float64) *FindingHistoryUpdate {
	_u.mutation.ResetExploitability()
	_u.mutation.SetExploitability(v)
	return _u
}

// SetNillableExploitability sets the "exploitability" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableExploitability(v *float64) *FindingHistoryUpdate {
	if v != nil {
		_u.SetExploitability(*v)
	}
	return _u
}

// AddExploitability adds value to the "exploitability" field.
func (_u *FindingHistoryUpdate) AddExploitability(v float64) *FindingHistoryUpdate {
	_u.mutation.AddExploitability(v)
	return _u
}

// ClearExploitability clears the value of the "exploitability" field.
func (_u *FindingHistoryUpdate) ClearExploitability() *FindingHistoryUpdate {
	_u.mutation.ClearExploitability()
	return _u
}

// SetPriority sets the "priority" field.
func (_u *FindingHistoryUpdate) SetPriority(v string) *FindingHistoryUpdate {
	_u.mutation.SetPriority(v)
	return _u
}

// SetNillablePriority sets the "priority" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillablePriority(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetPriority(*v)
	}
	return _u
}

// ClearPriority clears the value of the "priority" field.
func (_u *FindingHistoryUpdate) ClearPriority() *FindingHistoryUpdate {
	_u.mutation.ClearPriority()
	return _u
}

// SetOpen sets the "open" field.
func (_u *FindingHistoryUpdate) SetOpen(v bool) *FindingHistoryUpdate {
	_u.mutation.SetOpen(v)
	return _u
}

// SetNillableOpen sets the "open" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableOpen(v *bool) *FindingHistoryUpdate {
	if v != nil {
		_u.SetOpen(*v)
	}
	return _u
}

// ClearOpen clears the value of the "open" field.
func (_u *FindingHistoryUpdate) ClearOpen() *FindingHistoryUpdate {
	_u.mutation.ClearOpen()
	return _u
}

// SetBlocksProduction sets the "blocks_production" field.
func (_u *FindingHistoryUpdate) SetBlocksProduction(v bool) *FindingHistoryUpdate {
	_u.mutation.SetBlocksProduction(v)
	return _u
}

// SetNillableBlocksProduction sets the "blocks_production" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableBlocksProduction(v *bool) *FindingHistoryUpdate {
	if v != nil {
		_u.SetBlocksProduction(*v)
	}
	return _u
}

// ClearBlocksProduction clears the value of the "blocks_production" field.
func (_u *FindingHistoryUpdate) ClearBlocksProduction() *FindingHistoryUpdate {
	_u.mutation.ClearBlocksProduction()
	return _u
}

// SetProduction sets the "production" field.
func (_u *FindingHistoryUpdate) SetProduction(v bool) *FindingHistoryUpdate {
	_u.mutation.SetProduction(v)
	return _u
}

// SetNillableProduction sets the "production" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableProduction(v *bool) *FindingHistoryUpdate {
	if v != nil {
		_u.SetProduction(*v)
	}
	return _u
}

// ClearProduction clears the value of the "production" field.
func (_u *FindingHistoryUpdate) ClearProduction() *FindingHistoryUpdate {
	_u.mutation.ClearProduction()
	return _u
}

// SetPublic sets the "public" field.
func (_u *FindingHistoryUpdate) SetPublic(v bool) *FindingHistoryUpdate {
	_u.mutation.SetPublic(v)
	return _u
}

// SetNillablePublic sets the "public" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillablePublic(v *bool) *FindingHistoryUpdate {
	if v != nil {
		_u.SetPublic(*v)
	}
	return _u
}

// ClearPublic clears the value of the "public" field.
func (_u *FindingHistoryUpdate) ClearPublic() *FindingHistoryUpdate {
	_u.mutation.ClearPublic()
	return _u
}

// SetValidated sets the "validated" field.
func (_u *FindingHistoryUpdate) SetValidated(v bool) *FindingHistoryUpdate {
	_u.mutation.SetValidated(v)
	return _u
}

// SetNillableValidated sets the "validated" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableValidated(v *bool) *FindingHistoryUpdate {
	if v != nil {
		_u.SetValidated(*v)
	}
	return _u
}

// ClearValidated clears the value of the "validated" field.
func (_u *FindingHistoryUpdate) ClearValidated() *FindingHistoryUpdate {
	_u.mutation.ClearValidated()
	return _u
}

// SetAssessmentID sets the "assessment_id" field.
func (_u *FindingHistoryUpdate) SetAssessmentID(v string) *FindingHistoryUpdate {
	_u.mutation.SetAssessmentID(v)
	return _u
}

// SetNillableAssessmentID sets the "assessment_id" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableAssessmentID(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetAssessmentID(*v)
	}
	return _u
}

// ClearAssessmentID clears the value of the "assessment_id" field.
func (_u *FindingHistoryUpdate) ClearAssessmentID() *FindingHistoryUpdate {
	_u.mutation.ClearAssessmentID()
	return _u
}

// SetDescription sets the "description" field.
func (_u *FindingHistoryUpdate) SetDescription(v string) *FindingHistoryUpdate {
	_u.mutation.SetDescription(v)
	return _u
}

// SetNillableDescription sets the "description" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableDescription(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetDescription(*v)
	}
	return _u
}

// ClearDescription clears the value of the "description" field.
func (_u *FindingHistoryUpdate) ClearDescription() *FindingHistoryUpdate {
	_u.mutation.ClearDescription()
	return _u
}

// SetRecommendation sets the "recommendation" field.
func (_u *FindingHistoryUpdate) SetRecommendation(v string) *FindingHistoryUpdate {
	_u.mutation.SetRecommendation(v)
	return _u
}

// SetNillableRecommendation sets the "recommendation" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableRecommendation(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetRecommendation(*v)
	}
	return _u
}

// ClearRecommendation clears the value of the "recommendation" field.
func (_u *FindingHistoryUpdate) ClearRecommendation() *FindingHistoryUpdate {
	_u.mutation.ClearRecommendation()
	return _u
}

// SetRecommendedActions sets the "recommended_actions" field.
func (_u *FindingHistoryUpdate) SetRecommendedActions(v string) *FindingHistoryUpdate {
	_u.mutation.SetRecommendedActions(v)
	return _u
}

// SetNillableRecommendedActions sets the "recommended_actions" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableRecommendedActions(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetRecommendedActions(*v)
	}
	return _u
}

// ClearRecommendedActions clears the value of the "recommended_actions" field.
func (_u *FindingHistoryUpdate) ClearRecommendedActions() *FindingHistoryUpdate {
	_u.mutation.ClearRecommendedActions()
	return _u
}

// SetReferences sets the "references" field.
func (_u *FindingHistoryUpdate) SetReferences(v []string) *FindingHistoryUpdate {
	_u.mutation.SetReferences(v)
	return _u
}

// AppendReferences appends value to the "references" field.
func (_u *FindingHistoryUpdate) AppendReferences(v []string) *FindingHistoryUpdate {
	_u.mutation.AppendReferences(v)
	return _u
}

// ClearReferences clears the value of the "references" field.
func (_u *FindingHistoryUpdate) ClearReferences() *FindingHistoryUpdate {
	_u.mutation.ClearReferences()
	return _u
}

// SetStepsToReproduce sets the "steps_to_reproduce" field.
func (_u *FindingHistoryUpdate) SetStepsToReproduce(v []string) *FindingHistoryUpdate {
	_u.mutation.SetStepsToReproduce(v)
	return _u
}

// AppendStepsToReproduce appends value to the "steps_to_reproduce" field.
func (_u *FindingHistoryUpdate) AppendStepsToReproduce(v []string) *FindingHistoryUpdate {
	_u.mutation.AppendStepsToReproduce(v)
	return _u
}

// ClearStepsToReproduce clears the value of the "steps_to_reproduce" field.
func (_u *FindingHistoryUpdate) ClearStepsToReproduce() *FindingHistoryUpdate {
	_u.mutation.ClearStepsToReproduce()
	return _u
}

// SetTargets sets the "targets" field.
func (_u *FindingHistoryUpdate) SetTargets(v []string) *FindingHistoryUpdate {
	_u.mutation.SetTargets(v)
	return _u
}

// AppendTargets appends value to the "targets" field.
func (_u *FindingHistoryUpdate) AppendTargets(v []string) *FindingHistoryUpdate {
	_u.mutation.AppendTargets(v)
	return _u
}

// ClearTargets clears the value of the "targets" field.
func (_u *FindingHistoryUpdate) ClearTargets() *FindingHistoryUpdate {
	_u.mutation.ClearTargets()
	return _u
}

// SetTargetDetails sets the "target_details" field.
func (_u *FindingHistoryUpdate) SetTargetDetails(v map[string]interface{}) *FindingHistoryUpdate {
	_u.mutation.SetTargetDetails(v)
	return _u
}

// ClearTargetDetails clears the value of the "target_details" field.
func (_u *FindingHistoryUpdate) ClearTargetDetails() *FindingHistoryUpdate {
	_u.mutation.ClearTargetDetails()
	return _u
}

// SetVector sets the "vector" field.
func (_u *FindingHistoryUpdate) SetVector(v string) *FindingHistoryUpdate {
	_u.mutation.SetVector(v)
	return _u
}

// SetNillableVector sets the "vector" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableVector(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetVector(*v)
	}
	return _u
}

// ClearVector clears the value of the "vector" field.
func (_u *FindingHistoryUpdate) ClearVector() *FindingHistoryUpdate {
	_u.mutation.ClearVector()
	return _u
}

// SetRemediationSLA sets the "remediation_sla" field.
func (_u *FindingHistoryUpdate) SetRemediationSLA(v int) *FindingHistoryUpdate {
	_u.mutation.ResetRemediationSLA()
	_u.mutation.SetRemediationSLA(v)
	return _u
}

// SetNillableRemediationSLA sets the "remediation_sla" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableRemediationSLA(v *int) *FindingHistoryUpdate {
	if v != nil {
		_u.SetRemediationSLA(*v)
	}
	return _u
}

// AddRemediationSLA adds value to the "remediation_sla" field.
func (_u *FindingHistoryUpdate) AddRemediationSLA(v int) *FindingHistoryUpdate {
	_u.mutation.AddRemediationSLA(v)
	return _u
}

// ClearRemediationSLA clears the value of the "remediation_sla" field.
func (_u *FindingHistoryUpdate) ClearRemediationSLA() *FindingHistoryUpdate {
	_u.mutation.ClearRemediationSLA()
	return _u
}

// SetStatus sets the "status" field.
func (_u *FindingHistoryUpdate) SetStatus(v string) *FindingHistoryUpdate {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableStatus(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// ClearStatus clears the value of the "status" field.
func (_u *FindingHistoryUpdate) ClearStatus() *FindingHistoryUpdate {
	_u.mutation.ClearStatus()
	return _u
}

// SetEventTime sets the "event_time" field.
func (_u *FindingHistoryUpdate) SetEventTime(v models.DateTime) *FindingHistoryUpdate {
	_u.mutation.SetEventTime(v)
	return _u
}

// SetNillableEventTime sets the "event_time" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableEventTime(v *models.DateTime) *FindingHistoryUpdate {
	if v != nil {
		_u.SetEventTime(*v)
	}
	return _u
}

// ClearEventTime clears the value of the "event_time" field.
func (_u *FindingHistoryUpdate) ClearEventTime() *FindingHistoryUpdate {
	_u.mutation.ClearEventTime()
	return _u
}

// SetReportedAt sets the "reported_at" field.
func (_u *FindingHistoryUpdate) SetReportedAt(v models.DateTime) *FindingHistoryUpdate {
	_u.mutation.SetReportedAt(v)
	return _u
}

// SetNillableReportedAt sets the "reported_at" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableReportedAt(v *models.DateTime) *FindingHistoryUpdate {
	if v != nil {
		_u.SetReportedAt(*v)
	}
	return _u
}

// ClearReportedAt clears the value of the "reported_at" field.
func (_u *FindingHistoryUpdate) ClearReportedAt() *FindingHistoryUpdate {
	_u.mutation.ClearReportedAt()
	return _u
}

// SetSourceUpdatedAt sets the "source_updated_at" field.
func (_u *FindingHistoryUpdate) SetSourceUpdatedAt(v models.DateTime) *FindingHistoryUpdate {
	_u.mutation.SetSourceUpdatedAt(v)
	return _u
}

// SetNillableSourceUpdatedAt sets the "source_updated_at" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableSourceUpdatedAt(v *models.DateTime) *FindingHistoryUpdate {
	if v != nil {
		_u.SetSourceUpdatedAt(*v)
	}
	return _u
}

// ClearSourceUpdatedAt clears the value of the "source_updated_at" field.
func (_u *FindingHistoryUpdate) ClearSourceUpdatedAt() *FindingHistoryUpdate {
	_u.mutation.ClearSourceUpdatedAt()
	return _u
}

// SetExternalURI sets the "external_uri" field.
func (_u *FindingHistoryUpdate) SetExternalURI(v string) *FindingHistoryUpdate {
	_u.mutation.SetExternalURI(v)
	return _u
}

// SetNillableExternalURI sets the "external_uri" field if the given value is not nil.
func (_u *FindingHistoryUpdate) SetNillableExternalURI(v *string) *FindingHistoryUpdate {
	if v != nil {
		_u.SetExternalURI(*v)
	}
	return _u
}

// ClearExternalURI clears the value of the "external_uri" field.
func (_u *FindingHistoryUpdate) ClearExternalURI() *FindingHistoryUpdate {
	_u.mutation.ClearExternalURI()
	return _u
}

// SetMetadata sets the "metadata" field.
func (_u *FindingHistoryUpdate) SetMetadata(v map[string]interface{}) *FindingHistoryUpdate {
	_u.mutation.SetMetadata(v)
	return _u
}

// ClearMetadata clears the value of the "metadata" field.
func (_u *FindingHistoryUpdate) ClearMetadata() *FindingHistoryUpdate {
	_u.mutation.ClearMetadata()
	return _u
}

// SetRawPayload sets the "raw_payload" field.
func (_u *FindingHistoryUpdate) SetRawPayload(v map[string]interface{}) *FindingHistoryUpdate {
	_u.mutation.SetRawPayload(v)
	return _u
}

// ClearRawPayload clears the value of the "raw_payload" field.
func (_u *FindingHistoryUpdate) ClearRawPayload() *FindingHistoryUpdate {
	_u.mutation.ClearRawPayload()
	return _u
}

// Mutation returns the FindingHistoryMutation object of the builder.
func (_u *FindingHistoryUpdate) Mutation() *FindingHistoryMutation {
	return _u.mutation
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (_u *FindingHistoryUpdate) Save(ctx context.Context) (int, error) {
	if err := _u.defaults(); err != nil {
		return 0, err
	}
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *FindingHistoryUpdate) SaveX(ctx context.Context) int {
	affected, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (_u *FindingHistoryUpdate) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *FindingHistoryUpdate) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *FindingHistoryUpdate) defaults() error {
	if _, ok := _u.mutation.UpdatedAt(); !ok && !_u.mutation.UpdatedAtCleared() {
		if findinghistory.UpdateDefaultUpdatedAt == nil {
			return fmt.Errorf("generated: uninitialized findinghistory.UpdateDefaultUpdatedAt (forgotten import generated/runtime?)")
		}
		v := findinghistory.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
	return nil
}

// Modify adds a statement modifier for attaching custom logic to the UPDATE statement.
func (_u *FindingHistoryUpdate) Modify(modifiers ...func(u *sql.UpdateBuilder)) *FindingHistoryUpdate {
	_u.modifiers = append(_u.modifiers, modifiers...)
	return _u
}

func (_u *FindingHistoryUpdate) sqlSave(ctx context.Context) (_node int, err error) {
	_spec := sqlgraph.NewUpdateSpec(findinghistory.Table, findinghistory.Columns, sqlgraph.NewFieldSpec(findinghistory.FieldID, field.TypeString))
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if _u.mutation.RefCleared() {
		_spec.ClearField(findinghistory.FieldRef, field.TypeString)
	}
	if _u.mutation.CreatedAtCleared() {
		_spec.ClearField(findinghistory.FieldCreatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(findinghistory.FieldUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.UpdatedAtCleared() {
		_spec.ClearField(findinghistory.FieldUpdatedAt, field.TypeTime)
	}
	if _u.mutation.CreatedByCleared() {
		_spec.ClearField(findinghistory.FieldCreatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.UpdatedBy(); ok {
		_spec.SetField(findinghistory.FieldUpdatedBy, field.TypeString, value)
	}
	if _u.mutation.UpdatedByCleared() {
		_spec.ClearField(findinghistory.FieldUpdatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.DeletedAt(); ok {
		_spec.SetField(findinghistory.FieldDeletedAt, field.TypeTime, value)
	}
	if _u.mutation.DeletedAtCleared() {
		_spec.ClearField(findinghistory.FieldDeletedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.DeletedBy(); ok {
		_spec.SetField(findinghistory.FieldDeletedBy, field.TypeString, value)
	}
	if _u.mutation.DeletedByCleared() {
		_spec.ClearField(findinghistory.FieldDeletedBy, field.TypeString)
	}
	if value, ok := _u.mutation.Tags(); ok {
		_spec.SetField(findinghistory.FieldTags, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedTags(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldTags, value)
		})
	}
	if _u.mutation.TagsCleared() {
		_spec.ClearField(findinghistory.FieldTags, field.TypeJSON)
	}
	if _u.mutation.OwnerIDCleared() {
		_spec.ClearField(findinghistory.FieldOwnerID, field.TypeString)
	}
	if _u.mutation.SystemOwnedCleared() {
		_spec.ClearField(findinghistory.FieldSystemOwned, field.TypeBool)
	}
	if value, ok := _u.mutation.InternalNotes(); ok {
		_spec.SetField(findinghistory.FieldInternalNotes, field.TypeString, value)
	}
	if _u.mutation.InternalNotesCleared() {
		_spec.ClearField(findinghistory.FieldInternalNotes, field.TypeString)
	}
	if value, ok := _u.mutation.SystemInternalID(); ok {
		_spec.SetField(findinghistory.FieldSystemInternalID, field.TypeString, value)
	}
	if _u.mutation.SystemInternalIDCleared() {
		_spec.ClearField(findinghistory.FieldSystemInternalID, field.TypeString)
	}
	if value, ok := _u.mutation.ExternalID(); ok {
		_spec.SetField(findinghistory.FieldExternalID, field.TypeString, value)
	}
	if _u.mutation.ExternalIDCleared() {
		_spec.ClearField(findinghistory.FieldExternalID, field.TypeString)
	}
	if value, ok := _u.mutation.ExternalOwnerID(); ok {
		_spec.SetField(findinghistory.FieldExternalOwnerID, field.TypeString, value)
	}
	if _u.mutation.ExternalOwnerIDCleared() {
		_spec.ClearField(findinghistory.FieldExternalOwnerID, field.TypeString)
	}
	if value, ok := _u.mutation.Source(); ok {
		_spec.SetField(findinghistory.FieldSource, field.TypeString, value)
	}
	if _u.mutation.SourceCleared() {
		_spec.ClearField(findinghistory.FieldSource, field.TypeString)
	}
	if value, ok := _u.mutation.ResourceName(); ok {
		_spec.SetField(findinghistory.FieldResourceName, field.TypeString, value)
	}
	if _u.mutation.ResourceNameCleared() {
		_spec.ClearField(findinghistory.FieldResourceName, field.TypeString)
	}
	if value, ok := _u.mutation.DisplayName(); ok {
		_spec.SetField(findinghistory.FieldDisplayName, field.TypeString, value)
	}
	if _u.mutation.DisplayNameCleared() {
		_spec.ClearField(findinghistory.FieldDisplayName, field.TypeString)
	}
	if value, ok := _u.mutation.State(); ok {
		_spec.SetField(findinghistory.FieldState, field.TypeString, value)
	}
	if _u.mutation.StateCleared() {
		_spec.ClearField(findinghistory.FieldState, field.TypeString)
	}
	if value, ok := _u.mutation.Category(); ok {
		_spec.SetField(findinghistory.FieldCategory, field.TypeString, value)
	}
	if _u.mutation.CategoryCleared() {
		_spec.ClearField(findinghistory.FieldCategory, field.TypeString)
	}
	if value, ok := _u.mutation.Categories(); ok {
		_spec.SetField(findinghistory.FieldCategories, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedCategories(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldCategories, value)
		})
	}
	if _u.mutation.CategoriesCleared() {
		_spec.ClearField(findinghistory.FieldCategories, field.TypeJSON)
	}
	if value, ok := _u.mutation.FindingClass(); ok {
		_spec.SetField(findinghistory.FieldFindingClass, field.TypeString, value)
	}
	if _u.mutation.FindingClassCleared() {
		_spec.ClearField(findinghistory.FieldFindingClass, field.TypeString)
	}
	if value, ok := _u.mutation.Severity(); ok {
		_spec.SetField(findinghistory.FieldSeverity, field.TypeString, value)
	}
	if _u.mutation.SeverityCleared() {
		_spec.ClearField(findinghistory.FieldSeverity, field.TypeString)
	}
	if value, ok := _u.mutation.NumericSeverity(); ok {
		_spec.SetField(findinghistory.FieldNumericSeverity, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedNumericSeverity(); ok {
		_spec.AddField(findinghistory.FieldNumericSeverity, field.TypeFloat64, value)
	}
	if _u.mutation.NumericSeverityCleared() {
		_spec.ClearField(findinghistory.FieldNumericSeverity, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Score(); ok {
		_spec.SetField(findinghistory.FieldScore, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedScore(); ok {
		_spec.AddField(findinghistory.FieldScore, field.TypeFloat64, value)
	}
	if _u.mutation.ScoreCleared() {
		_spec.ClearField(findinghistory.FieldScore, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Impact(); ok {
		_spec.SetField(findinghistory.FieldImpact, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedImpact(); ok {
		_spec.AddField(findinghistory.FieldImpact, field.TypeFloat64, value)
	}
	if _u.mutation.ImpactCleared() {
		_spec.ClearField(findinghistory.FieldImpact, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Exploitability(); ok {
		_spec.SetField(findinghistory.FieldExploitability, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedExploitability(); ok {
		_spec.AddField(findinghistory.FieldExploitability, field.TypeFloat64, value)
	}
	if _u.mutation.ExploitabilityCleared() {
		_spec.ClearField(findinghistory.FieldExploitability, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Priority(); ok {
		_spec.SetField(findinghistory.FieldPriority, field.TypeString, value)
	}
	if _u.mutation.PriorityCleared() {
		_spec.ClearField(findinghistory.FieldPriority, field.TypeString)
	}
	if value, ok := _u.mutation.Open(); ok {
		_spec.SetField(findinghistory.FieldOpen, field.TypeBool, value)
	}
	if _u.mutation.OpenCleared() {
		_spec.ClearField(findinghistory.FieldOpen, field.TypeBool)
	}
	if value, ok := _u.mutation.BlocksProduction(); ok {
		_spec.SetField(findinghistory.FieldBlocksProduction, field.TypeBool, value)
	}
	if _u.mutation.BlocksProductionCleared() {
		_spec.ClearField(findinghistory.FieldBlocksProduction, field.TypeBool)
	}
	if value, ok := _u.mutation.Production(); ok {
		_spec.SetField(findinghistory.FieldProduction, field.TypeBool, value)
	}
	if _u.mutation.ProductionCleared() {
		_spec.ClearField(findinghistory.FieldProduction, field.TypeBool)
	}
	if value, ok := _u.mutation.Public(); ok {
		_spec.SetField(findinghistory.FieldPublic, field.TypeBool, value)
	}
	if _u.mutation.PublicCleared() {
		_spec.ClearField(findinghistory.FieldPublic, field.TypeBool)
	}
	if value, ok := _u.mutation.Validated(); ok {
		_spec.SetField(findinghistory.FieldValidated, field.TypeBool, value)
	}
	if _u.mutation.ValidatedCleared() {
		_spec.ClearField(findinghistory.FieldValidated, field.TypeBool)
	}
	if value, ok := _u.mutation.AssessmentID(); ok {
		_spec.SetField(findinghistory.FieldAssessmentID, field.TypeString, value)
	}
	if _u.mutation.AssessmentIDCleared() {
		_spec.ClearField(findinghistory.FieldAssessmentID, field.TypeString)
	}
	if value, ok := _u.mutation.Description(); ok {
		_spec.SetField(findinghistory.FieldDescription, field.TypeString, value)
	}
	if _u.mutation.DescriptionCleared() {
		_spec.ClearField(findinghistory.FieldDescription, field.TypeString)
	}
	if value, ok := _u.mutation.Recommendation(); ok {
		_spec.SetField(findinghistory.FieldRecommendation, field.TypeString, value)
	}
	if _u.mutation.RecommendationCleared() {
		_spec.ClearField(findinghistory.FieldRecommendation, field.TypeString)
	}
	if value, ok := _u.mutation.RecommendedActions(); ok {
		_spec.SetField(findinghistory.FieldRecommendedActions, field.TypeString, value)
	}
	if _u.mutation.RecommendedActionsCleared() {
		_spec.ClearField(findinghistory.FieldRecommendedActions, field.TypeString)
	}
	if value, ok := _u.mutation.References(); ok {
		_spec.SetField(findinghistory.FieldReferences, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedReferences(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldReferences, value)
		})
	}
	if _u.mutation.ReferencesCleared() {
		_spec.ClearField(findinghistory.FieldReferences, field.TypeJSON)
	}
	if value, ok := _u.mutation.StepsToReproduce(); ok {
		_spec.SetField(findinghistory.FieldStepsToReproduce, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedStepsToReproduce(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldStepsToReproduce, value)
		})
	}
	if _u.mutation.StepsToReproduceCleared() {
		_spec.ClearField(findinghistory.FieldStepsToReproduce, field.TypeJSON)
	}
	if value, ok := _u.mutation.Targets(); ok {
		_spec.SetField(findinghistory.FieldTargets, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedTargets(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldTargets, value)
		})
	}
	if _u.mutation.TargetsCleared() {
		_spec.ClearField(findinghistory.FieldTargets, field.TypeJSON)
	}
	if value, ok := _u.mutation.TargetDetails(); ok {
		_spec.SetField(findinghistory.FieldTargetDetails, field.TypeJSON, value)
	}
	if _u.mutation.TargetDetailsCleared() {
		_spec.ClearField(findinghistory.FieldTargetDetails, field.TypeJSON)
	}
	if value, ok := _u.mutation.Vector(); ok {
		_spec.SetField(findinghistory.FieldVector, field.TypeString, value)
	}
	if _u.mutation.VectorCleared() {
		_spec.ClearField(findinghistory.FieldVector, field.TypeString)
	}
	if value, ok := _u.mutation.RemediationSLA(); ok {
		_spec.SetField(findinghistory.FieldRemediationSLA, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedRemediationSLA(); ok {
		_spec.AddField(findinghistory.FieldRemediationSLA, field.TypeInt, value)
	}
	if _u.mutation.RemediationSLACleared() {
		_spec.ClearField(findinghistory.FieldRemediationSLA, field.TypeInt)
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(findinghistory.FieldStatus, field.TypeString, value)
	}
	if _u.mutation.StatusCleared() {
		_spec.ClearField(findinghistory.FieldStatus, field.TypeString)
	}
	if value, ok := _u.mutation.EventTime(); ok {
		_spec.SetField(findinghistory.FieldEventTime, field.TypeTime, value)
	}
	if _u.mutation.EventTimeCleared() {
		_spec.ClearField(findinghistory.FieldEventTime, field.TypeTime)
	}
	if value, ok := _u.mutation.ReportedAt(); ok {
		_spec.SetField(findinghistory.FieldReportedAt, field.TypeTime, value)
	}
	if _u.mutation.ReportedAtCleared() {
		_spec.ClearField(findinghistory.FieldReportedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.SourceUpdatedAt(); ok {
		_spec.SetField(findinghistory.FieldSourceUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.SourceUpdatedAtCleared() {
		_spec.ClearField(findinghistory.FieldSourceUpdatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.ExternalURI(); ok {
		_spec.SetField(findinghistory.FieldExternalURI, field.TypeString, value)
	}
	if _u.mutation.ExternalURICleared() {
		_spec.ClearField(findinghistory.FieldExternalURI, field.TypeString)
	}
	if value, ok := _u.mutation.Metadata(); ok {
		_spec.SetField(findinghistory.FieldMetadata, field.TypeJSON, value)
	}
	if _u.mutation.MetadataCleared() {
		_spec.ClearField(findinghistory.FieldMetadata, field.TypeJSON)
	}
	if value, ok := _u.mutation.RawPayload(); ok {
		_spec.SetField(findinghistory.FieldRawPayload, field.TypeJSON, value)
	}
	if _u.mutation.RawPayloadCleared() {
		_spec.ClearField(findinghistory.FieldRawPayload, field.TypeJSON)
	}
	_spec.Node.Schema = _u.schemaConfig.FindingHistory
	ctx = internal.NewSchemaConfigContext(ctx, _u.schemaConfig)
	_spec.AddModifiers(_u.modifiers...)
	if _node, err = sqlgraph.UpdateNodes(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{findinghistory.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	_u.mutation.done = true
	return _node, nil
}

// FindingHistoryUpdateOne is the builder for updating a single FindingHistory entity.
type FindingHistoryUpdateOne struct {
	config
	fields    []string
	hooks     []Hook
	mutation  *FindingHistoryMutation
	modifiers []func(*sql.UpdateBuilder)
}

// SetUpdatedAt sets the "updated_at" field.
func (_u *FindingHistoryUpdateOne) SetUpdatedAt(v time.Time) *FindingHistoryUpdateOne {
	_u.mutation.SetUpdatedAt(v)
	return _u
}

// ClearUpdatedAt clears the value of the "updated_at" field.
func (_u *FindingHistoryUpdateOne) ClearUpdatedAt() *FindingHistoryUpdateOne {
	_u.mutation.ClearUpdatedAt()
	return _u
}

// SetUpdatedBy sets the "updated_by" field.
func (_u *FindingHistoryUpdateOne) SetUpdatedBy(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetUpdatedBy(v)
	return _u
}

// SetNillableUpdatedBy sets the "updated_by" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableUpdatedBy(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetUpdatedBy(*v)
	}
	return _u
}

// ClearUpdatedBy clears the value of the "updated_by" field.
func (_u *FindingHistoryUpdateOne) ClearUpdatedBy() *FindingHistoryUpdateOne {
	_u.mutation.ClearUpdatedBy()
	return _u
}

// SetDeletedAt sets the "deleted_at" field.
func (_u *FindingHistoryUpdateOne) SetDeletedAt(v time.Time) *FindingHistoryUpdateOne {
	_u.mutation.SetDeletedAt(v)
	return _u
}

// SetNillableDeletedAt sets the "deleted_at" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableDeletedAt(v *time.Time) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetDeletedAt(*v)
	}
	return _u
}

// ClearDeletedAt clears the value of the "deleted_at" field.
func (_u *FindingHistoryUpdateOne) ClearDeletedAt() *FindingHistoryUpdateOne {
	_u.mutation.ClearDeletedAt()
	return _u
}

// SetDeletedBy sets the "deleted_by" field.
func (_u *FindingHistoryUpdateOne) SetDeletedBy(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetDeletedBy(v)
	return _u
}

// SetNillableDeletedBy sets the "deleted_by" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableDeletedBy(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetDeletedBy(*v)
	}
	return _u
}

// ClearDeletedBy clears the value of the "deleted_by" field.
func (_u *FindingHistoryUpdateOne) ClearDeletedBy() *FindingHistoryUpdateOne {
	_u.mutation.ClearDeletedBy()
	return _u
}

// SetTags sets the "tags" field.
func (_u *FindingHistoryUpdateOne) SetTags(v []string) *FindingHistoryUpdateOne {
	_u.mutation.SetTags(v)
	return _u
}

// AppendTags appends value to the "tags" field.
func (_u *FindingHistoryUpdateOne) AppendTags(v []string) *FindingHistoryUpdateOne {
	_u.mutation.AppendTags(v)
	return _u
}

// ClearTags clears the value of the "tags" field.
func (_u *FindingHistoryUpdateOne) ClearTags() *FindingHistoryUpdateOne {
	_u.mutation.ClearTags()
	return _u
}

// SetInternalNotes sets the "internal_notes" field.
func (_u *FindingHistoryUpdateOne) SetInternalNotes(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetInternalNotes(v)
	return _u
}

// SetNillableInternalNotes sets the "internal_notes" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableInternalNotes(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetInternalNotes(*v)
	}
	return _u
}

// ClearInternalNotes clears the value of the "internal_notes" field.
func (_u *FindingHistoryUpdateOne) ClearInternalNotes() *FindingHistoryUpdateOne {
	_u.mutation.ClearInternalNotes()
	return _u
}

// SetSystemInternalID sets the "system_internal_id" field.
func (_u *FindingHistoryUpdateOne) SetSystemInternalID(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetSystemInternalID(v)
	return _u
}

// SetNillableSystemInternalID sets the "system_internal_id" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableSystemInternalID(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetSystemInternalID(*v)
	}
	return _u
}

// ClearSystemInternalID clears the value of the "system_internal_id" field.
func (_u *FindingHistoryUpdateOne) ClearSystemInternalID() *FindingHistoryUpdateOne {
	_u.mutation.ClearSystemInternalID()
	return _u
}

// SetExternalID sets the "external_id" field.
func (_u *FindingHistoryUpdateOne) SetExternalID(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetExternalID(v)
	return _u
}

// SetNillableExternalID sets the "external_id" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableExternalID(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetExternalID(*v)
	}
	return _u
}

// ClearExternalID clears the value of the "external_id" field.
func (_u *FindingHistoryUpdateOne) ClearExternalID() *FindingHistoryUpdateOne {
	_u.mutation.ClearExternalID()
	return _u
}

// SetExternalOwnerID sets the "external_owner_id" field.
func (_u *FindingHistoryUpdateOne) SetExternalOwnerID(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetExternalOwnerID(v)
	return _u
}

// SetNillableExternalOwnerID sets the "external_owner_id" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableExternalOwnerID(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetExternalOwnerID(*v)
	}
	return _u
}

// ClearExternalOwnerID clears the value of the "external_owner_id" field.
func (_u *FindingHistoryUpdateOne) ClearExternalOwnerID() *FindingHistoryUpdateOne {
	_u.mutation.ClearExternalOwnerID()
	return _u
}

// SetSource sets the "source" field.
func (_u *FindingHistoryUpdateOne) SetSource(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetSource(v)
	return _u
}

// SetNillableSource sets the "source" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableSource(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetSource(*v)
	}
	return _u
}

// ClearSource clears the value of the "source" field.
func (_u *FindingHistoryUpdateOne) ClearSource() *FindingHistoryUpdateOne {
	_u.mutation.ClearSource()
	return _u
}

// SetResourceName sets the "resource_name" field.
func (_u *FindingHistoryUpdateOne) SetResourceName(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetResourceName(v)
	return _u
}

// SetNillableResourceName sets the "resource_name" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableResourceName(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetResourceName(*v)
	}
	return _u
}

// ClearResourceName clears the value of the "resource_name" field.
func (_u *FindingHistoryUpdateOne) ClearResourceName() *FindingHistoryUpdateOne {
	_u.mutation.ClearResourceName()
	return _u
}

// SetDisplayName sets the "display_name" field.
func (_u *FindingHistoryUpdateOne) SetDisplayName(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetDisplayName(v)
	return _u
}

// SetNillableDisplayName sets the "display_name" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableDisplayName(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetDisplayName(*v)
	}
	return _u
}

// ClearDisplayName clears the value of the "display_name" field.
func (_u *FindingHistoryUpdateOne) ClearDisplayName() *FindingHistoryUpdateOne {
	_u.mutation.ClearDisplayName()
	return _u
}

// SetState sets the "state" field.
func (_u *FindingHistoryUpdateOne) SetState(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetState(v)
	return _u
}

// SetNillableState sets the "state" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableState(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetState(*v)
	}
	return _u
}

// ClearState clears the value of the "state" field.
func (_u *FindingHistoryUpdateOne) ClearState() *FindingHistoryUpdateOne {
	_u.mutation.ClearState()
	return _u
}

// SetCategory sets the "category" field.
func (_u *FindingHistoryUpdateOne) SetCategory(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetCategory(v)
	return _u
}

// SetNillableCategory sets the "category" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableCategory(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetCategory(*v)
	}
	return _u
}

// ClearCategory clears the value of the "category" field.
func (_u *FindingHistoryUpdateOne) ClearCategory() *FindingHistoryUpdateOne {
	_u.mutation.ClearCategory()
	return _u
}

// SetCategories sets the "categories" field.
func (_u *FindingHistoryUpdateOne) SetCategories(v []string) *FindingHistoryUpdateOne {
	_u.mutation.SetCategories(v)
	return _u
}

// AppendCategories appends value to the "categories" field.
func (_u *FindingHistoryUpdateOne) AppendCategories(v []string) *FindingHistoryUpdateOne {
	_u.mutation.AppendCategories(v)
	return _u
}

// ClearCategories clears the value of the "categories" field.
func (_u *FindingHistoryUpdateOne) ClearCategories() *FindingHistoryUpdateOne {
	_u.mutation.ClearCategories()
	return _u
}

// SetFindingClass sets the "finding_class" field.
func (_u *FindingHistoryUpdateOne) SetFindingClass(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetFindingClass(v)
	return _u
}

// SetNillableFindingClass sets the "finding_class" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableFindingClass(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetFindingClass(*v)
	}
	return _u
}

// ClearFindingClass clears the value of the "finding_class" field.
func (_u *FindingHistoryUpdateOne) ClearFindingClass() *FindingHistoryUpdateOne {
	_u.mutation.ClearFindingClass()
	return _u
}

// SetSeverity sets the "severity" field.
func (_u *FindingHistoryUpdateOne) SetSeverity(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetSeverity(v)
	return _u
}

// SetNillableSeverity sets the "severity" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableSeverity(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetSeverity(*v)
	}
	return _u
}

// ClearSeverity clears the value of the "severity" field.
func (_u *FindingHistoryUpdateOne) ClearSeverity() *FindingHistoryUpdateOne {
	_u.mutation.ClearSeverity()
	return _u
}

// SetNumericSeverity sets the "numeric_severity" field.
func (_u *FindingHistoryUpdateOne) SetNumericSeverity(v float64) *FindingHistoryUpdateOne {
	_u.mutation.ResetNumericSeverity()
	_u.mutation.SetNumericSeverity(v)
	return _u
}

// SetNillableNumericSeverity sets the "numeric_severity" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableNumericSeverity(v *float64) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetNumericSeverity(*v)
	}
	return _u
}

// AddNumericSeverity adds value to the "numeric_severity" field.
func (_u *FindingHistoryUpdateOne) AddNumericSeverity(v float64) *FindingHistoryUpdateOne {
	_u.mutation.AddNumericSeverity(v)
	return _u
}

// ClearNumericSeverity clears the value of the "numeric_severity" field.
func (_u *FindingHistoryUpdateOne) ClearNumericSeverity() *FindingHistoryUpdateOne {
	_u.mutation.ClearNumericSeverity()
	return _u
}

// SetScore sets the "score" field.
func (_u *FindingHistoryUpdateOne) SetScore(v float64) *FindingHistoryUpdateOne {
	_u.mutation.ResetScore()
	_u.mutation.SetScore(v)
	return _u
}

// SetNillableScore sets the "score" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableScore(v *float64) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetScore(*v)
	}
	return _u
}

// AddScore adds value to the "score" field.
func (_u *FindingHistoryUpdateOne) AddScore(v float64) *FindingHistoryUpdateOne {
	_u.mutation.AddScore(v)
	return _u
}

// ClearScore clears the value of the "score" field.
func (_u *FindingHistoryUpdateOne) ClearScore() *FindingHistoryUpdateOne {
	_u.mutation.ClearScore()
	return _u
}

// SetImpact sets the "impact" field.
func (_u *FindingHistoryUpdateOne) SetImpact(v float64) *FindingHistoryUpdateOne {
	_u.mutation.ResetImpact()
	_u.mutation.SetImpact(v)
	return _u
}

// SetNillableImpact sets the "impact" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableImpact(v *float64) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetImpact(*v)
	}
	return _u
}

// AddImpact adds value to the "impact" field.
func (_u *FindingHistoryUpdateOne) AddImpact(v float64) *FindingHistoryUpdateOne {
	_u.mutation.AddImpact(v)
	return _u
}

// ClearImpact clears the value of the "impact" field.
func (_u *FindingHistoryUpdateOne) ClearImpact() *FindingHistoryUpdateOne {
	_u.mutation.ClearImpact()
	return _u
}

// SetExploitability sets the "exploitability" field.
func (_u *FindingHistoryUpdateOne) SetExploitability(v float64) *FindingHistoryUpdateOne {
	_u.mutation.ResetExploitability()
	_u.mutation.SetExploitability(v)
	return _u
}

// SetNillableExploitability sets the "exploitability" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableExploitability(v *float64) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetExploitability(*v)
	}
	return _u
}

// AddExploitability adds value to the "exploitability" field.
func (_u *FindingHistoryUpdateOne) AddExploitability(v float64) *FindingHistoryUpdateOne {
	_u.mutation.AddExploitability(v)
	return _u
}

// ClearExploitability clears the value of the "exploitability" field.
func (_u *FindingHistoryUpdateOne) ClearExploitability() *FindingHistoryUpdateOne {
	_u.mutation.ClearExploitability()
	return _u
}

// SetPriority sets the "priority" field.
func (_u *FindingHistoryUpdateOne) SetPriority(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetPriority(v)
	return _u
}

// SetNillablePriority sets the "priority" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillablePriority(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetPriority(*v)
	}
	return _u
}

// ClearPriority clears the value of the "priority" field.
func (_u *FindingHistoryUpdateOne) ClearPriority() *FindingHistoryUpdateOne {
	_u.mutation.ClearPriority()
	return _u
}

// SetOpen sets the "open" field.
func (_u *FindingHistoryUpdateOne) SetOpen(v bool) *FindingHistoryUpdateOne {
	_u.mutation.SetOpen(v)
	return _u
}

// SetNillableOpen sets the "open" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableOpen(v *bool) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetOpen(*v)
	}
	return _u
}

// ClearOpen clears the value of the "open" field.
func (_u *FindingHistoryUpdateOne) ClearOpen() *FindingHistoryUpdateOne {
	_u.mutation.ClearOpen()
	return _u
}

// SetBlocksProduction sets the "blocks_production" field.
func (_u *FindingHistoryUpdateOne) SetBlocksProduction(v bool) *FindingHistoryUpdateOne {
	_u.mutation.SetBlocksProduction(v)
	return _u
}

// SetNillableBlocksProduction sets the "blocks_production" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableBlocksProduction(v *bool) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetBlocksProduction(*v)
	}
	return _u
}

// ClearBlocksProduction clears the value of the "blocks_production" field.
func (_u *FindingHistoryUpdateOne) ClearBlocksProduction() *FindingHistoryUpdateOne {
	_u.mutation.ClearBlocksProduction()
	return _u
}

// SetProduction sets the "production" field.
func (_u *FindingHistoryUpdateOne) SetProduction(v bool) *FindingHistoryUpdateOne {
	_u.mutation.SetProduction(v)
	return _u
}

// SetNillableProduction sets the "production" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableProduction(v *bool) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetProduction(*v)
	}
	return _u
}

// ClearProduction clears the value of the "production" field.
func (_u *FindingHistoryUpdateOne) ClearProduction() *FindingHistoryUpdateOne {
	_u.mutation.ClearProduction()
	return _u
}

// SetPublic sets the "public" field.
func (_u *FindingHistoryUpdateOne) SetPublic(v bool) *FindingHistoryUpdateOne {
	_u.mutation.SetPublic(v)
	return _u
}

// SetNillablePublic sets the "public" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillablePublic(v *bool) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetPublic(*v)
	}
	return _u
}

// ClearPublic clears the value of the "public" field.
func (_u *FindingHistoryUpdateOne) ClearPublic() *FindingHistoryUpdateOne {
	_u.mutation.ClearPublic()
	return _u
}

// SetValidated sets the "validated" field.
func (_u *FindingHistoryUpdateOne) SetValidated(v bool) *FindingHistoryUpdateOne {
	_u.mutation.SetValidated(v)
	return _u
}

// SetNillableValidated sets the "validated" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableValidated(v *bool) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetValidated(*v)
	}
	return _u
}

// ClearValidated clears the value of the "validated" field.
func (_u *FindingHistoryUpdateOne) ClearValidated() *FindingHistoryUpdateOne {
	_u.mutation.ClearValidated()
	return _u
}

// SetAssessmentID sets the "assessment_id" field.
func (_u *FindingHistoryUpdateOne) SetAssessmentID(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetAssessmentID(v)
	return _u
}

// SetNillableAssessmentID sets the "assessment_id" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableAssessmentID(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetAssessmentID(*v)
	}
	return _u
}

// ClearAssessmentID clears the value of the "assessment_id" field.
func (_u *FindingHistoryUpdateOne) ClearAssessmentID() *FindingHistoryUpdateOne {
	_u.mutation.ClearAssessmentID()
	return _u
}

// SetDescription sets the "description" field.
func (_u *FindingHistoryUpdateOne) SetDescription(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetDescription(v)
	return _u
}

// SetNillableDescription sets the "description" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableDescription(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetDescription(*v)
	}
	return _u
}

// ClearDescription clears the value of the "description" field.
func (_u *FindingHistoryUpdateOne) ClearDescription() *FindingHistoryUpdateOne {
	_u.mutation.ClearDescription()
	return _u
}

// SetRecommendation sets the "recommendation" field.
func (_u *FindingHistoryUpdateOne) SetRecommendation(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetRecommendation(v)
	return _u
}

// SetNillableRecommendation sets the "recommendation" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableRecommendation(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetRecommendation(*v)
	}
	return _u
}

// ClearRecommendation clears the value of the "recommendation" field.
func (_u *FindingHistoryUpdateOne) ClearRecommendation() *FindingHistoryUpdateOne {
	_u.mutation.ClearRecommendation()
	return _u
}

// SetRecommendedActions sets the "recommended_actions" field.
func (_u *FindingHistoryUpdateOne) SetRecommendedActions(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetRecommendedActions(v)
	return _u
}

// SetNillableRecommendedActions sets the "recommended_actions" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableRecommendedActions(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetRecommendedActions(*v)
	}
	return _u
}

// ClearRecommendedActions clears the value of the "recommended_actions" field.
func (_u *FindingHistoryUpdateOne) ClearRecommendedActions() *FindingHistoryUpdateOne {
	_u.mutation.ClearRecommendedActions()
	return _u
}

// SetReferences sets the "references" field.
func (_u *FindingHistoryUpdateOne) SetReferences(v []string) *FindingHistoryUpdateOne {
	_u.mutation.SetReferences(v)
	return _u
}

// AppendReferences appends value to the "references" field.
func (_u *FindingHistoryUpdateOne) AppendReferences(v []string) *FindingHistoryUpdateOne {
	_u.mutation.AppendReferences(v)
	return _u
}

// ClearReferences clears the value of the "references" field.
func (_u *FindingHistoryUpdateOne) ClearReferences() *FindingHistoryUpdateOne {
	_u.mutation.ClearReferences()
	return _u
}

// SetStepsToReproduce sets the "steps_to_reproduce" field.
func (_u *FindingHistoryUpdateOne) SetStepsToReproduce(v []string) *FindingHistoryUpdateOne {
	_u.mutation.SetStepsToReproduce(v)
	return _u
}

// AppendStepsToReproduce appends value to the "steps_to_reproduce" field.
func (_u *FindingHistoryUpdateOne) AppendStepsToReproduce(v []string) *FindingHistoryUpdateOne {
	_u.mutation.AppendStepsToReproduce(v)
	return _u
}

// ClearStepsToReproduce clears the value of the "steps_to_reproduce" field.
func (_u *FindingHistoryUpdateOne) ClearStepsToReproduce() *FindingHistoryUpdateOne {
	_u.mutation.ClearStepsToReproduce()
	return _u
}

// SetTargets sets the "targets" field.
func (_u *FindingHistoryUpdateOne) SetTargets(v []string) *FindingHistoryUpdateOne {
	_u.mutation.SetTargets(v)
	return _u
}

// AppendTargets appends value to the "targets" field.
func (_u *FindingHistoryUpdateOne) AppendTargets(v []string) *FindingHistoryUpdateOne {
	_u.mutation.AppendTargets(v)
	return _u
}

// ClearTargets clears the value of the "targets" field.
func (_u *FindingHistoryUpdateOne) ClearTargets() *FindingHistoryUpdateOne {
	_u.mutation.ClearTargets()
	return _u
}

// SetTargetDetails sets the "target_details" field.
func (_u *FindingHistoryUpdateOne) SetTargetDetails(v map[string]interface{}) *FindingHistoryUpdateOne {
	_u.mutation.SetTargetDetails(v)
	return _u
}

// ClearTargetDetails clears the value of the "target_details" field.
func (_u *FindingHistoryUpdateOne) ClearTargetDetails() *FindingHistoryUpdateOne {
	_u.mutation.ClearTargetDetails()
	return _u
}

// SetVector sets the "vector" field.
func (_u *FindingHistoryUpdateOne) SetVector(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetVector(v)
	return _u
}

// SetNillableVector sets the "vector" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableVector(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetVector(*v)
	}
	return _u
}

// ClearVector clears the value of the "vector" field.
func (_u *FindingHistoryUpdateOne) ClearVector() *FindingHistoryUpdateOne {
	_u.mutation.ClearVector()
	return _u
}

// SetRemediationSLA sets the "remediation_sla" field.
func (_u *FindingHistoryUpdateOne) SetRemediationSLA(v int) *FindingHistoryUpdateOne {
	_u.mutation.ResetRemediationSLA()
	_u.mutation.SetRemediationSLA(v)
	return _u
}

// SetNillableRemediationSLA sets the "remediation_sla" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableRemediationSLA(v *int) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetRemediationSLA(*v)
	}
	return _u
}

// AddRemediationSLA adds value to the "remediation_sla" field.
func (_u *FindingHistoryUpdateOne) AddRemediationSLA(v int) *FindingHistoryUpdateOne {
	_u.mutation.AddRemediationSLA(v)
	return _u
}

// ClearRemediationSLA clears the value of the "remediation_sla" field.
func (_u *FindingHistoryUpdateOne) ClearRemediationSLA() *FindingHistoryUpdateOne {
	_u.mutation.ClearRemediationSLA()
	return _u
}

// SetStatus sets the "status" field.
func (_u *FindingHistoryUpdateOne) SetStatus(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetStatus(v)
	return _u
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableStatus(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetStatus(*v)
	}
	return _u
}

// ClearStatus clears the value of the "status" field.
func (_u *FindingHistoryUpdateOne) ClearStatus() *FindingHistoryUpdateOne {
	_u.mutation.ClearStatus()
	return _u
}

// SetEventTime sets the "event_time" field.
func (_u *FindingHistoryUpdateOne) SetEventTime(v models.DateTime) *FindingHistoryUpdateOne {
	_u.mutation.SetEventTime(v)
	return _u
}

// SetNillableEventTime sets the "event_time" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableEventTime(v *models.DateTime) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetEventTime(*v)
	}
	return _u
}

// ClearEventTime clears the value of the "event_time" field.
func (_u *FindingHistoryUpdateOne) ClearEventTime() *FindingHistoryUpdateOne {
	_u.mutation.ClearEventTime()
	return _u
}

// SetReportedAt sets the "reported_at" field.
func (_u *FindingHistoryUpdateOne) SetReportedAt(v models.DateTime) *FindingHistoryUpdateOne {
	_u.mutation.SetReportedAt(v)
	return _u
}

// SetNillableReportedAt sets the "reported_at" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableReportedAt(v *models.DateTime) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetReportedAt(*v)
	}
	return _u
}

// ClearReportedAt clears the value of the "reported_at" field.
func (_u *FindingHistoryUpdateOne) ClearReportedAt() *FindingHistoryUpdateOne {
	_u.mutation.ClearReportedAt()
	return _u
}

// SetSourceUpdatedAt sets the "source_updated_at" field.
func (_u *FindingHistoryUpdateOne) SetSourceUpdatedAt(v models.DateTime) *FindingHistoryUpdateOne {
	_u.mutation.SetSourceUpdatedAt(v)
	return _u
}

// SetNillableSourceUpdatedAt sets the "source_updated_at" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableSourceUpdatedAt(v *models.DateTime) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetSourceUpdatedAt(*v)
	}
	return _u
}

// ClearSourceUpdatedAt clears the value of the "source_updated_at" field.
func (_u *FindingHistoryUpdateOne) ClearSourceUpdatedAt() *FindingHistoryUpdateOne {
	_u.mutation.ClearSourceUpdatedAt()
	return _u
}

// SetExternalURI sets the "external_uri" field.
func (_u *FindingHistoryUpdateOne) SetExternalURI(v string) *FindingHistoryUpdateOne {
	_u.mutation.SetExternalURI(v)
	return _u
}

// SetNillableExternalURI sets the "external_uri" field if the given value is not nil.
func (_u *FindingHistoryUpdateOne) SetNillableExternalURI(v *string) *FindingHistoryUpdateOne {
	if v != nil {
		_u.SetExternalURI(*v)
	}
	return _u
}

// ClearExternalURI clears the value of the "external_uri" field.
func (_u *FindingHistoryUpdateOne) ClearExternalURI() *FindingHistoryUpdateOne {
	_u.mutation.ClearExternalURI()
	return _u
}

// SetMetadata sets the "metadata" field.
func (_u *FindingHistoryUpdateOne) SetMetadata(v map[string]interface{}) *FindingHistoryUpdateOne {
	_u.mutation.SetMetadata(v)
	return _u
}

// ClearMetadata clears the value of the "metadata" field.
func (_u *FindingHistoryUpdateOne) ClearMetadata() *FindingHistoryUpdateOne {
	_u.mutation.ClearMetadata()
	return _u
}

// SetRawPayload sets the "raw_payload" field.
func (_u *FindingHistoryUpdateOne) SetRawPayload(v map[string]interface{}) *FindingHistoryUpdateOne {
	_u.mutation.SetRawPayload(v)
	return _u
}

// ClearRawPayload clears the value of the "raw_payload" field.
func (_u *FindingHistoryUpdateOne) ClearRawPayload() *FindingHistoryUpdateOne {
	_u.mutation.ClearRawPayload()
	return _u
}

// Mutation returns the FindingHistoryMutation object of the builder.
func (_u *FindingHistoryUpdateOne) Mutation() *FindingHistoryMutation {
	return _u.mutation
}

// Where appends a list predicates to the FindingHistoryUpdate builder.
func (_u *FindingHistoryUpdateOne) Where(ps ...predicate.FindingHistory) *FindingHistoryUpdateOne {
	_u.mutation.Where(ps...)
	return _u
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (_u *FindingHistoryUpdateOne) Select(field string, fields ...string) *FindingHistoryUpdateOne {
	_u.fields = append([]string{field}, fields...)
	return _u
}

// Save executes the query and returns the updated FindingHistory entity.
func (_u *FindingHistoryUpdateOne) Save(ctx context.Context) (*FindingHistory, error) {
	if err := _u.defaults(); err != nil {
		return nil, err
	}
	return withHooks(ctx, _u.sqlSave, _u.mutation, _u.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (_u *FindingHistoryUpdateOne) SaveX(ctx context.Context) *FindingHistory {
	node, err := _u.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (_u *FindingHistoryUpdateOne) Exec(ctx context.Context) error {
	_, err := _u.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (_u *FindingHistoryUpdateOne) ExecX(ctx context.Context) {
	if err := _u.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (_u *FindingHistoryUpdateOne) defaults() error {
	if _, ok := _u.mutation.UpdatedAt(); !ok && !_u.mutation.UpdatedAtCleared() {
		if findinghistory.UpdateDefaultUpdatedAt == nil {
			return fmt.Errorf("generated: uninitialized findinghistory.UpdateDefaultUpdatedAt (forgotten import generated/runtime?)")
		}
		v := findinghistory.UpdateDefaultUpdatedAt()
		_u.mutation.SetUpdatedAt(v)
	}
	return nil
}

// Modify adds a statement modifier for attaching custom logic to the UPDATE statement.
func (_u *FindingHistoryUpdateOne) Modify(modifiers ...func(u *sql.UpdateBuilder)) *FindingHistoryUpdateOne {
	_u.modifiers = append(_u.modifiers, modifiers...)
	return _u
}

func (_u *FindingHistoryUpdateOne) sqlSave(ctx context.Context) (_node *FindingHistory, err error) {
	_spec := sqlgraph.NewUpdateSpec(findinghistory.Table, findinghistory.Columns, sqlgraph.NewFieldSpec(findinghistory.FieldID, field.TypeString))
	id, ok := _u.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`generated: missing "FindingHistory.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := _u.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, findinghistory.FieldID)
		for _, f := range fields {
			if !findinghistory.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("generated: invalid field %q for query", f)}
			}
			if f != findinghistory.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := _u.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if _u.mutation.RefCleared() {
		_spec.ClearField(findinghistory.FieldRef, field.TypeString)
	}
	if _u.mutation.CreatedAtCleared() {
		_spec.ClearField(findinghistory.FieldCreatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.UpdatedAt(); ok {
		_spec.SetField(findinghistory.FieldUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.UpdatedAtCleared() {
		_spec.ClearField(findinghistory.FieldUpdatedAt, field.TypeTime)
	}
	if _u.mutation.CreatedByCleared() {
		_spec.ClearField(findinghistory.FieldCreatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.UpdatedBy(); ok {
		_spec.SetField(findinghistory.FieldUpdatedBy, field.TypeString, value)
	}
	if _u.mutation.UpdatedByCleared() {
		_spec.ClearField(findinghistory.FieldUpdatedBy, field.TypeString)
	}
	if value, ok := _u.mutation.DeletedAt(); ok {
		_spec.SetField(findinghistory.FieldDeletedAt, field.TypeTime, value)
	}
	if _u.mutation.DeletedAtCleared() {
		_spec.ClearField(findinghistory.FieldDeletedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.DeletedBy(); ok {
		_spec.SetField(findinghistory.FieldDeletedBy, field.TypeString, value)
	}
	if _u.mutation.DeletedByCleared() {
		_spec.ClearField(findinghistory.FieldDeletedBy, field.TypeString)
	}
	if value, ok := _u.mutation.Tags(); ok {
		_spec.SetField(findinghistory.FieldTags, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedTags(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldTags, value)
		})
	}
	if _u.mutation.TagsCleared() {
		_spec.ClearField(findinghistory.FieldTags, field.TypeJSON)
	}
	if _u.mutation.OwnerIDCleared() {
		_spec.ClearField(findinghistory.FieldOwnerID, field.TypeString)
	}
	if _u.mutation.SystemOwnedCleared() {
		_spec.ClearField(findinghistory.FieldSystemOwned, field.TypeBool)
	}
	if value, ok := _u.mutation.InternalNotes(); ok {
		_spec.SetField(findinghistory.FieldInternalNotes, field.TypeString, value)
	}
	if _u.mutation.InternalNotesCleared() {
		_spec.ClearField(findinghistory.FieldInternalNotes, field.TypeString)
	}
	if value, ok := _u.mutation.SystemInternalID(); ok {
		_spec.SetField(findinghistory.FieldSystemInternalID, field.TypeString, value)
	}
	if _u.mutation.SystemInternalIDCleared() {
		_spec.ClearField(findinghistory.FieldSystemInternalID, field.TypeString)
	}
	if value, ok := _u.mutation.ExternalID(); ok {
		_spec.SetField(findinghistory.FieldExternalID, field.TypeString, value)
	}
	if _u.mutation.ExternalIDCleared() {
		_spec.ClearField(findinghistory.FieldExternalID, field.TypeString)
	}
	if value, ok := _u.mutation.ExternalOwnerID(); ok {
		_spec.SetField(findinghistory.FieldExternalOwnerID, field.TypeString, value)
	}
	if _u.mutation.ExternalOwnerIDCleared() {
		_spec.ClearField(findinghistory.FieldExternalOwnerID, field.TypeString)
	}
	if value, ok := _u.mutation.Source(); ok {
		_spec.SetField(findinghistory.FieldSource, field.TypeString, value)
	}
	if _u.mutation.SourceCleared() {
		_spec.ClearField(findinghistory.FieldSource, field.TypeString)
	}
	if value, ok := _u.mutation.ResourceName(); ok {
		_spec.SetField(findinghistory.FieldResourceName, field.TypeString, value)
	}
	if _u.mutation.ResourceNameCleared() {
		_spec.ClearField(findinghistory.FieldResourceName, field.TypeString)
	}
	if value, ok := _u.mutation.DisplayName(); ok {
		_spec.SetField(findinghistory.FieldDisplayName, field.TypeString, value)
	}
	if _u.mutation.DisplayNameCleared() {
		_spec.ClearField(findinghistory.FieldDisplayName, field.TypeString)
	}
	if value, ok := _u.mutation.State(); ok {
		_spec.SetField(findinghistory.FieldState, field.TypeString, value)
	}
	if _u.mutation.StateCleared() {
		_spec.ClearField(findinghistory.FieldState, field.TypeString)
	}
	if value, ok := _u.mutation.Category(); ok {
		_spec.SetField(findinghistory.FieldCategory, field.TypeString, value)
	}
	if _u.mutation.CategoryCleared() {
		_spec.ClearField(findinghistory.FieldCategory, field.TypeString)
	}
	if value, ok := _u.mutation.Categories(); ok {
		_spec.SetField(findinghistory.FieldCategories, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedCategories(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldCategories, value)
		})
	}
	if _u.mutation.CategoriesCleared() {
		_spec.ClearField(findinghistory.FieldCategories, field.TypeJSON)
	}
	if value, ok := _u.mutation.FindingClass(); ok {
		_spec.SetField(findinghistory.FieldFindingClass, field.TypeString, value)
	}
	if _u.mutation.FindingClassCleared() {
		_spec.ClearField(findinghistory.FieldFindingClass, field.TypeString)
	}
	if value, ok := _u.mutation.Severity(); ok {
		_spec.SetField(findinghistory.FieldSeverity, field.TypeString, value)
	}
	if _u.mutation.SeverityCleared() {
		_spec.ClearField(findinghistory.FieldSeverity, field.TypeString)
	}
	if value, ok := _u.mutation.NumericSeverity(); ok {
		_spec.SetField(findinghistory.FieldNumericSeverity, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedNumericSeverity(); ok {
		_spec.AddField(findinghistory.FieldNumericSeverity, field.TypeFloat64, value)
	}
	if _u.mutation.NumericSeverityCleared() {
		_spec.ClearField(findinghistory.FieldNumericSeverity, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Score(); ok {
		_spec.SetField(findinghistory.FieldScore, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedScore(); ok {
		_spec.AddField(findinghistory.FieldScore, field.TypeFloat64, value)
	}
	if _u.mutation.ScoreCleared() {
		_spec.ClearField(findinghistory.FieldScore, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Impact(); ok {
		_spec.SetField(findinghistory.FieldImpact, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedImpact(); ok {
		_spec.AddField(findinghistory.FieldImpact, field.TypeFloat64, value)
	}
	if _u.mutation.ImpactCleared() {
		_spec.ClearField(findinghistory.FieldImpact, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Exploitability(); ok {
		_spec.SetField(findinghistory.FieldExploitability, field.TypeFloat64, value)
	}
	if value, ok := _u.mutation.AddedExploitability(); ok {
		_spec.AddField(findinghistory.FieldExploitability, field.TypeFloat64, value)
	}
	if _u.mutation.ExploitabilityCleared() {
		_spec.ClearField(findinghistory.FieldExploitability, field.TypeFloat64)
	}
	if value, ok := _u.mutation.Priority(); ok {
		_spec.SetField(findinghistory.FieldPriority, field.TypeString, value)
	}
	if _u.mutation.PriorityCleared() {
		_spec.ClearField(findinghistory.FieldPriority, field.TypeString)
	}
	if value, ok := _u.mutation.Open(); ok {
		_spec.SetField(findinghistory.FieldOpen, field.TypeBool, value)
	}
	if _u.mutation.OpenCleared() {
		_spec.ClearField(findinghistory.FieldOpen, field.TypeBool)
	}
	if value, ok := _u.mutation.BlocksProduction(); ok {
		_spec.SetField(findinghistory.FieldBlocksProduction, field.TypeBool, value)
	}
	if _u.mutation.BlocksProductionCleared() {
		_spec.ClearField(findinghistory.FieldBlocksProduction, field.TypeBool)
	}
	if value, ok := _u.mutation.Production(); ok {
		_spec.SetField(findinghistory.FieldProduction, field.TypeBool, value)
	}
	if _u.mutation.ProductionCleared() {
		_spec.ClearField(findinghistory.FieldProduction, field.TypeBool)
	}
	if value, ok := _u.mutation.Public(); ok {
		_spec.SetField(findinghistory.FieldPublic, field.TypeBool, value)
	}
	if _u.mutation.PublicCleared() {
		_spec.ClearField(findinghistory.FieldPublic, field.TypeBool)
	}
	if value, ok := _u.mutation.Validated(); ok {
		_spec.SetField(findinghistory.FieldValidated, field.TypeBool, value)
	}
	if _u.mutation.ValidatedCleared() {
		_spec.ClearField(findinghistory.FieldValidated, field.TypeBool)
	}
	if value, ok := _u.mutation.AssessmentID(); ok {
		_spec.SetField(findinghistory.FieldAssessmentID, field.TypeString, value)
	}
	if _u.mutation.AssessmentIDCleared() {
		_spec.ClearField(findinghistory.FieldAssessmentID, field.TypeString)
	}
	if value, ok := _u.mutation.Description(); ok {
		_spec.SetField(findinghistory.FieldDescription, field.TypeString, value)
	}
	if _u.mutation.DescriptionCleared() {
		_spec.ClearField(findinghistory.FieldDescription, field.TypeString)
	}
	if value, ok := _u.mutation.Recommendation(); ok {
		_spec.SetField(findinghistory.FieldRecommendation, field.TypeString, value)
	}
	if _u.mutation.RecommendationCleared() {
		_spec.ClearField(findinghistory.FieldRecommendation, field.TypeString)
	}
	if value, ok := _u.mutation.RecommendedActions(); ok {
		_spec.SetField(findinghistory.FieldRecommendedActions, field.TypeString, value)
	}
	if _u.mutation.RecommendedActionsCleared() {
		_spec.ClearField(findinghistory.FieldRecommendedActions, field.TypeString)
	}
	if value, ok := _u.mutation.References(); ok {
		_spec.SetField(findinghistory.FieldReferences, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedReferences(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldReferences, value)
		})
	}
	if _u.mutation.ReferencesCleared() {
		_spec.ClearField(findinghistory.FieldReferences, field.TypeJSON)
	}
	if value, ok := _u.mutation.StepsToReproduce(); ok {
		_spec.SetField(findinghistory.FieldStepsToReproduce, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedStepsToReproduce(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldStepsToReproduce, value)
		})
	}
	if _u.mutation.StepsToReproduceCleared() {
		_spec.ClearField(findinghistory.FieldStepsToReproduce, field.TypeJSON)
	}
	if value, ok := _u.mutation.Targets(); ok {
		_spec.SetField(findinghistory.FieldTargets, field.TypeJSON, value)
	}
	if value, ok := _u.mutation.AppendedTargets(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, findinghistory.FieldTargets, value)
		})
	}
	if _u.mutation.TargetsCleared() {
		_spec.ClearField(findinghistory.FieldTargets, field.TypeJSON)
	}
	if value, ok := _u.mutation.TargetDetails(); ok {
		_spec.SetField(findinghistory.FieldTargetDetails, field.TypeJSON, value)
	}
	if _u.mutation.TargetDetailsCleared() {
		_spec.ClearField(findinghistory.FieldTargetDetails, field.TypeJSON)
	}
	if value, ok := _u.mutation.Vector(); ok {
		_spec.SetField(findinghistory.FieldVector, field.TypeString, value)
	}
	if _u.mutation.VectorCleared() {
		_spec.ClearField(findinghistory.FieldVector, field.TypeString)
	}
	if value, ok := _u.mutation.RemediationSLA(); ok {
		_spec.SetField(findinghistory.FieldRemediationSLA, field.TypeInt, value)
	}
	if value, ok := _u.mutation.AddedRemediationSLA(); ok {
		_spec.AddField(findinghistory.FieldRemediationSLA, field.TypeInt, value)
	}
	if _u.mutation.RemediationSLACleared() {
		_spec.ClearField(findinghistory.FieldRemediationSLA, field.TypeInt)
	}
	if value, ok := _u.mutation.Status(); ok {
		_spec.SetField(findinghistory.FieldStatus, field.TypeString, value)
	}
	if _u.mutation.StatusCleared() {
		_spec.ClearField(findinghistory.FieldStatus, field.TypeString)
	}
	if value, ok := _u.mutation.EventTime(); ok {
		_spec.SetField(findinghistory.FieldEventTime, field.TypeTime, value)
	}
	if _u.mutation.EventTimeCleared() {
		_spec.ClearField(findinghistory.FieldEventTime, field.TypeTime)
	}
	if value, ok := _u.mutation.ReportedAt(); ok {
		_spec.SetField(findinghistory.FieldReportedAt, field.TypeTime, value)
	}
	if _u.mutation.ReportedAtCleared() {
		_spec.ClearField(findinghistory.FieldReportedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.SourceUpdatedAt(); ok {
		_spec.SetField(findinghistory.FieldSourceUpdatedAt, field.TypeTime, value)
	}
	if _u.mutation.SourceUpdatedAtCleared() {
		_spec.ClearField(findinghistory.FieldSourceUpdatedAt, field.TypeTime)
	}
	if value, ok := _u.mutation.ExternalURI(); ok {
		_spec.SetField(findinghistory.FieldExternalURI, field.TypeString, value)
	}
	if _u.mutation.ExternalURICleared() {
		_spec.ClearField(findinghistory.FieldExternalURI, field.TypeString)
	}
	if value, ok := _u.mutation.Metadata(); ok {
		_spec.SetField(findinghistory.FieldMetadata, field.TypeJSON, value)
	}
	if _u.mutation.MetadataCleared() {
		_spec.ClearField(findinghistory.FieldMetadata, field.TypeJSON)
	}
	if value, ok := _u.mutation.RawPayload(); ok {
		_spec.SetField(findinghistory.FieldRawPayload, field.TypeJSON, value)
	}
	if _u.mutation.RawPayloadCleared() {
		_spec.ClearField(findinghistory.FieldRawPayload, field.TypeJSON)
	}
	_spec.Node.Schema = _u.schemaConfig.FindingHistory
	ctx = internal.NewSchemaConfigContext(ctx, _u.schemaConfig)
	_spec.AddModifiers(_u.modifiers...)
	_node = &FindingHistory{config: _u.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, _u.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{findinghistory.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	_u.mutation.done = true
	return _node, nil
}
