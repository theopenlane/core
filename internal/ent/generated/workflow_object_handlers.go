package generated

import (
	"context"

	"github.com/theopenlane/core/common/enums"
	"github.com/theopenlane/core/internal/ent/generated/workflowinstance"
	"github.com/theopenlane/core/internal/ent/generated/workflowobjectref"
)

// Code generated by ent. DO NOT EDIT.
// This file is generated to provide object handler functions for workflow engine operations.

// SetWorkflowInstanceObjectID sets the appropriate object ID field on a WorkflowInstance create builder based on object type
func SetWorkflowInstanceObjectID(builder *WorkflowInstanceCreate, objectType enums.WorkflowObjectType, objectID string) *WorkflowInstanceCreate {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		return builder.SetActionPlanID(objectID)
	case enums.WorkflowObjectTypeControl:
		return builder.SetControlID(objectID)
	case enums.WorkflowObjectTypeEvidence:
		return builder.SetEvidenceID(objectID)
	case enums.WorkflowObjectTypeInternalPolicy:
		return builder.SetInternalPolicyID(objectID)
	case enums.WorkflowObjectTypeProcedure:
		return builder.SetProcedureID(objectID)
	case enums.WorkflowObjectTypeSubcontrol:
		return builder.SetSubcontrolID(objectID)
	default:
		return builder
	}
}

// SetWorkflowObjectRefObjectID sets the appropriate object ID field on a WorkflowObjectRef create builder based on object type
func SetWorkflowObjectRefObjectID(builder *WorkflowObjectRefCreate, objectType enums.WorkflowObjectType, objectID string) *WorkflowObjectRefCreate {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		return builder.SetActionPlanID(objectID)
	case enums.WorkflowObjectTypeControl:
		return builder.SetControlID(objectID)
	case enums.WorkflowObjectTypeEvidence:
		return builder.SetEvidenceID(objectID)
	case enums.WorkflowObjectTypeInternalPolicy:
		return builder.SetInternalPolicyID(objectID)
	case enums.WorkflowObjectTypeProcedure:
		return builder.SetProcedureID(objectID)
	case enums.WorkflowObjectTypeSubcontrol:
		return builder.SetSubcontrolID(objectID)
	default:
		return builder
	}
}

// ApplyWorkflowInstanceObjectPredicate adds the appropriate object ID predicate to a WorkflowInstance query based on object type
func ApplyWorkflowInstanceObjectPredicate(query *WorkflowInstanceQuery, objectType enums.WorkflowObjectType, objectID string) *WorkflowInstanceQuery {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		return query.Where(workflowinstance.ActionPlanIDEQ(objectID))
	case enums.WorkflowObjectTypeControl:
		return query.Where(workflowinstance.ControlIDEQ(objectID))
	case enums.WorkflowObjectTypeEvidence:
		return query.Where(workflowinstance.EvidenceIDEQ(objectID))
	case enums.WorkflowObjectTypeInternalPolicy:
		return query.Where(workflowinstance.InternalPolicyIDEQ(objectID))
	case enums.WorkflowObjectTypeProcedure:
		return query.Where(workflowinstance.ProcedureIDEQ(objectID))
	case enums.WorkflowObjectTypeSubcontrol:
		return query.Where(workflowinstance.SubcontrolIDEQ(objectID))
	default:
		return query
	}
}

// ApplyWorkflowObjectRefObjectPredicate adds the appropriate object ID predicate to a WorkflowObjectRef query based on object type.
func ApplyWorkflowObjectRefObjectPredicate(query *WorkflowObjectRefQuery, objectType enums.WorkflowObjectType, objectID string) *WorkflowObjectRefQuery {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		return query.Where(workflowobjectref.ActionPlanIDEQ(objectID))
	case enums.WorkflowObjectTypeControl:
		return query.Where(workflowobjectref.ControlIDEQ(objectID))
	case enums.WorkflowObjectTypeEvidence:
		return query.Where(workflowobjectref.EvidenceIDEQ(objectID))
	case enums.WorkflowObjectTypeInternalPolicy:
		return query.Where(workflowobjectref.InternalPolicyIDEQ(objectID))
	case enums.WorkflowObjectTypeProcedure:
		return query.Where(workflowobjectref.ProcedureIDEQ(objectID))
	case enums.WorkflowObjectTypeSubcontrol:
		return query.Where(workflowobjectref.SubcontrolIDEQ(objectID))
	default:
		return query
	}
}

// GetObjectOwnerID retrieves the owner ID for a workflow object by loading it from the database
func GetObjectOwnerID(ctx context.Context, client *Client, objectType enums.WorkflowObjectType, objectID string) (string, error) {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		rec, err := client.ActionPlan.Get(ctx, objectID)
		if err != nil {
			return "", err
		}
		return rec.OwnerID, nil
	case enums.WorkflowObjectTypeControl:
		rec, err := client.Control.Get(ctx, objectID)
		if err != nil {
			return "", err
		}
		return rec.OwnerID, nil
	case enums.WorkflowObjectTypeEvidence:
		rec, err := client.Evidence.Get(ctx, objectID)
		if err != nil {
			return "", err
		}
		return rec.OwnerID, nil
	case enums.WorkflowObjectTypeInternalPolicy:
		rec, err := client.InternalPolicy.Get(ctx, objectID)
		if err != nil {
			return "", err
		}
		return rec.OwnerID, nil
	case enums.WorkflowObjectTypeProcedure:
		rec, err := client.Procedure.Get(ctx, objectID)
		if err != nil {
			return "", err
		}
		return rec.OwnerID, nil
	case enums.WorkflowObjectTypeSubcontrol:
		rec, err := client.Subcontrol.Get(ctx, objectID)
		if err != nil {
			return "", err
		}
		return rec.OwnerID, nil
	default:
		return "", nil
	}
}

// ApplyObjectFieldUpdates applies field updates to a workflow object using the generated ApplyFieldUpdates method
func ApplyObjectFieldUpdates(ctx context.Context, client *Client, objectType enums.WorkflowObjectType, objectID string, updates map[string]any) error {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		return client.ActionPlan.ApplyFieldUpdates(ctx, objectID, updates)
	case enums.WorkflowObjectTypeControl:
		return client.Control.ApplyFieldUpdates(ctx, objectID, updates)
	case enums.WorkflowObjectTypeEvidence:
		return client.Evidence.ApplyFieldUpdates(ctx, objectID, updates)
	case enums.WorkflowObjectTypeInternalPolicy:
		return client.InternalPolicy.ApplyFieldUpdates(ctx, objectID, updates)
	case enums.WorkflowObjectTypeProcedure:
		return client.Procedure.ApplyFieldUpdates(ctx, objectID, updates)
	case enums.WorkflowObjectTypeSubcontrol:
		return client.Subcontrol.ApplyFieldUpdates(ctx, objectID, updates)
	default:
		return nil
	}
}
