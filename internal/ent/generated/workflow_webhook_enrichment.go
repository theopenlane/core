// Code generated by ent, DO NOT EDIT.

package generated

import (
	"context"
	"fmt"

	"github.com/theopenlane/core/common/enums"
)

// EnrichWebhookPayload enriches a webhook payload with fields from a workflow object
func (c *Client) EnrichWebhookPayload(ctx context.Context, objectType enums.WorkflowObjectType, objectID string, payload map[string]any) error {
	switch objectType {
	case enums.WorkflowObjectTypeActionPlan:
		entity, err := c.ActionPlan.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeCampaign:
		entity, err := c.Campaign.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeCampaignTarget:
		entity, err := c.CampaignTarget.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeControl:
		entity, err := c.Control.Get(ctx, objectID)
		if err != nil {
			return err
		}
		payload["title"] = entity.Title
		payload["status"] = entity.Status
		payload["ref_code"] = entity.RefCode
		return nil
	case enums.WorkflowObjectTypeEvidence:
		entity, err := c.Evidence.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeIdentityHolder:
		entity, err := c.IdentityHolder.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeInternalPolicy:
		entity, err := c.InternalPolicy.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypePlatform:
		entity, err := c.Platform.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeProcedure:
		entity, err := c.Procedure.Get(ctx, objectID)
		if err != nil {
			return err
		}
		// No fields marked with WebhookPayloadField annotation
		payload["id"] = entity.ID
		return nil
	case enums.WorkflowObjectTypeSubcontrol:
		entity, err := c.Subcontrol.Get(ctx, objectID)
		if err != nil {
			return err
		}
		payload["title"] = entity.Title
		payload["status"] = entity.Status
		return nil
	default:
		return fmt.Errorf("unsupported object type: %s", objectType)
	}
}

// EnrichActionPlanWebhookPayload enriches a webhook payload with ActionPlan fields
func (c *Client) EnrichActionPlanWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.ActionPlan.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichCampaignWebhookPayload enriches a webhook payload with Campaign fields
func (c *Client) EnrichCampaignWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.Campaign.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichCampaignTargetWebhookPayload enriches a webhook payload with CampaignTarget fields
func (c *Client) EnrichCampaignTargetWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.CampaignTarget.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichControlWebhookPayload enriches a webhook payload with Control fields
func (c *Client) EnrichControlWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.Control.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["title"] = entity.Title
	payload["status"] = entity.Status
	payload["ref_code"] = entity.RefCode
	return nil
}

// EnrichEvidenceWebhookPayload enriches a webhook payload with Evidence fields
func (c *Client) EnrichEvidenceWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.Evidence.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichIdentityHolderWebhookPayload enriches a webhook payload with IdentityHolder fields
func (c *Client) EnrichIdentityHolderWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.IdentityHolder.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichInternalPolicyWebhookPayload enriches a webhook payload with InternalPolicy fields
func (c *Client) EnrichInternalPolicyWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.InternalPolicy.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichPlatformWebhookPayload enriches a webhook payload with Platform fields
func (c *Client) EnrichPlatformWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.Platform.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichProcedureWebhookPayload enriches a webhook payload with Procedure fields
func (c *Client) EnrichProcedureWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.Procedure.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["id"] = entity.ID
	return nil
}

// EnrichSubcontrolWebhookPayload enriches a webhook payload with Subcontrol fields
func (c *Client) EnrichSubcontrolWebhookPayload(ctx context.Context, id string, payload map[string]any) error {
	entity, err := c.Subcontrol.Get(ctx, id)
	if err != nil {
		return err
	}
	payload["title"] = entity.Title
	payload["status"] = entity.Status
	return nil
}
